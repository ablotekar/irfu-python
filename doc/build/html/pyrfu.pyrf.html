
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pyrfu.pyrf package &#8212; pyrfu 1.6.7 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyrfu.solo package" href="pyrfu.solo.html" />
    <link rel="prev" title="pyrfu.plot package" href="pyrfu.plot.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyrfu.solo.html" title="pyrfu.solo package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pyrfu.plot.html" title="pyrfu.plot package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyrfu 1.6.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="pyrfu.html" accesskey="U">pyrfu package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyrfu.pyrf package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pyrfu-pyrf-package">
<h1>pyrfu.pyrf package<a class="headerlink" href="#pyrfu-pyrf-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrfu.pyrf.agyro_coeff">
<span id="pyrfu-pyrf-agyro-coeff-module"></span><h2>pyrfu.pyrf.agyro_coeff module<a class="headerlink" href="#module-pyrfu.pyrf.agyro_coeff" title="Permalink to this headline">¶</a></h2>
<p>agyro_coeff.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.agyro_coeff.agyro_coeff">
<code class="sig-prename descclassname">pyrfu.pyrf.agyro_coeff.</code><code class="sig-name descname">agyro_coeff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/agyro_coeff.html#agyro_coeff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.agyro_coeff.agyro_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes agyrotropy coefficient as in <a class="reference internal" href="#r7580c15bb7ab-1" id="id1">[1]</a></p>
<div class="math notranslate nohighlight">
\[Q = \frac{P_{12}^2 + P_{13}^2 + P_{23}^2}{P_\perp^2 + 2 P_\perp P_\parallel}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>p</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the pressure tensor</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>q</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the agyrotropy coefficient of the specie</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r7580c15bb7ab-1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Swisdak, M. (2016), Quantifying gyrotropy in magnetic reconnection, Geophys. Res. Lett., 43, 43–49,
doi: <a class="reference external" href="https://doi.org/10.1002/2015GL066980">https://doi.org/10.1002/2015GL066980</a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electron pressure tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_xyz_e</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Pe_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rotate electron pressure tensor to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_xyzfac_e</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">p_xyz_e</span><span class="p">,</span><span class="s2">&quot;fac&quot;</span><span class="p">,</span><span class="n">b_xyz</span><span class="p">,</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute agyrotropy coefficient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_e</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">agyro_coeff</span><span class="p">(</span><span class="n">p_xyzfac_e</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.avg_4sc">
<span id="pyrfu-pyrf-avg-4sc-module"></span><h2>pyrfu.pyrf.avg_4sc module<a class="headerlink" href="#module-pyrfu.pyrf.avg_4sc" title="Permalink to this headline">¶</a></h2>
<p>avg_4sc.py
&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.avg_4sc.avg_4sc">
<code class="sig-prename descclassname">pyrfu.pyrf.avg_4sc.</code><code class="sig-name descname">avg_4sc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b_list</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/avg_4sc.html#avg_4sc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.avg_4sc.avg_4sc" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the input quantity at the center of mass of the MMS tetrahedron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>List of the time series of the quantity for each spacecraft.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>b_avg</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input quantity a the enter of mass of the MMS tetrahedron.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu.mms</span> <span class="kn">import</span> <span class="n">get_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu.pyrf</span> <span class="kn">import</span> <span class="n">avg_4sc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mms</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="n">mms_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">avg_4sc</span><span class="p">(</span><span class="n">b_mms</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.c_4_grad">
<span id="pyrfu-pyrf-c-4-grad-module"></span><h2>pyrfu.pyrf.c_4_grad module<a class="headerlink" href="#module-pyrfu.pyrf.c_4_grad" title="Permalink to this headline">¶</a></h2>
<p>c_4_grad.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.c_4_grad.c_4_grad">
<code class="sig-prename descclassname">pyrfu.pyrf.c_4_grad.</code><code class="sig-name descname">c_4_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'grad'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/c_4_grad.html#c_4_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.c_4_grad.c_4_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate gradient of physical field using 4 spacecraft technique in <a class="reference internal" href="#r50258fd6a097-2" id="id3">[2]</a> <a class="reference internal" href="#r50258fd6a097-3" id="id4">[3]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the positions of the spacecraft</p>
</dd>
<dt><strong>b_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the magnetic field at the corresponding positions</p>
</dd>
<dt><strong>method</strong><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Method flag :</dt><dd><ul class="simple">
<li><p>“grad” : compute gradient (default)</p></li>
<li><p>“div” : compute divergence</p></li>
<li><p>“curl” : compute curl</p></li>
<li><p>“bdivb” : compute b.div(b)</p></li>
<li><p>“curv” : compute curvature</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the derivative of the input field corresponding to the method</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-pyrfu.pyrf.c_4_k" title="pyrfu.pyrf.c_4_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.pyrf.c_4_k</span></code></a></dt><dd><p>Calculates reciprocal vectors in barycentric coordinates.</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r50258fd6a097-2"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Dunlop, M. W., A. Balogh, K.-H. Glassmeier, and P. Robert (2002a), Four-point Cluster application of                            magnetic field analysis tools: The Curl- ometer, J. Geophys. Res., 107(A11), 1384,                                                                      doi : <a class="reference external" href="https://doi.org/10.1029/2001JA005088">https://doi.org/10.1029/2001JA005088</a>.</p>
</dd>
<dt class="label" id="r50258fd6a097-3"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Robert, P., et al. (1998), Accuracy of current determination, in Analysis Methods for Multi-Spacecraft                  Data, edited by G. Paschmann and P. W. Daly, pp. 395–418, Int. Space Sci. Inst., Bern.
url : <a class="reference external" href="http://www.issibern.ch/forads/sr-001-16.pdf">http://www.issibern.ch/forads/sr-001-16.pdf</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mms</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_mms</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_b</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_grad</span><span class="p">(</span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">,</span> <span class="s2">&quot;grad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.c_4_j">
<span id="pyrfu-pyrf-c-4-j-module"></span><h2>pyrfu.pyrf.c_4_j module<a class="headerlink" href="#module-pyrfu.pyrf.c_4_j" title="Permalink to this headline">¶</a></h2>
<p>c_4_j.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.c_4_j.c_4_j">
<code class="sig-prename descclassname">pyrfu.pyrf.c_4_j.</code><code class="sig-name descname">c_4_j</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_list</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/c_4_j.html#c_4_j"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.c_4_j.c_4_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate current density <span class="math notranslate nohighlight">\(\mathbf{J}\)</span> from using 4 spacecraft technique <a class="reference internal" href="#raf9a5c45efde-4" id="id7">[4]</a>, the divergence of the
magnetic field <span class="math notranslate nohighlight">\(\nabla . \mathbf{B}\)</span>, magnetic field at the center of mass of the tetrahedron,
<span class="math notranslate nohighlight">\(\mathbf{J}\times\mathbf{B}\)</span> force, part of the divergence of stress associated with curvature
<span class="math notranslate nohighlight">\(\nabla.\mathbf{T}_{shear}\)</span> and gradient of the magnetic pressure <span class="math notranslate nohighlight">\(\nabla P_b\)</span>.
Where :</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{J} = \frac{\nabla \times \mathbf{B}}{\mu_0}\\\mathbf{J}\times\mathbf{B} = \nabla.\mathbf{T}_{shear} + \nabla P_b\\\nabla.\mathbf{T}_{shear} = \frac{(\mathbf{B}.\nabla) \mathbf{B}}{\mu_0}\\\nabla P_b = \nabla \frac{B^2}{2\mu_0}\end{aligned}\end{align} \]</div>
<p>The divergence of the magnetic field is current density units as it shows the error on the estimation of the
current density <a class="reference internal" href="#raf9a5c45efde-5" id="id8">[5]</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the spacecraft position [km].</p>
</dd>
<dt><strong>b_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the magnetic field [nT].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>j</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the current density [A.m^{-2}].</p>
</dd>
<dt><strong>div_b</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the divergence of the magnetic field [A.m^{-2}].</p>
</dd>
<dt><strong>b_avg</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field at the center of mass of the tetrahedron,
sampled at 1st SC time steps [nT].</p>
</dd>
<dt><strong>jxb</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the <span class="math notranslate nohighlight">\(\mathbf{J}\times\mathbf{B}\)</span> force [T.A].</p>
</dd>
<dt><strong>div_t_shear</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the part of the divergence of stress associated with curvature units [T A/m^2].</p>
</dd>
<dt><strong>div_pb</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the gradient of the magnetic pressure.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-pyrfu.pyrf.c_4_k" title="pyrfu.pyrf.c_4_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.pyrf.c_4_k</span></code></a></dt><dd><p>Calculates reciprocal vectors in barycentric coordinates.</p>
</dd>
<dt><a class="reference internal" href="#module-pyrfu.pyrf.c_4_grad" title="pyrfu.pyrf.c_4_grad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.pyrf.c_4_grad</span></code></a></dt><dd><p>Calculate gradient of physical field using 4 spacecraft technique.</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="raf9a5c45efde-4"><span class="brackets"><a class="fn-backref" href="#id7">4</a></span></dt>
<dd><p>Dunlop, M. W., A. Balogh, K.-H. Glassmeier, and P. Robert (2002a), Four-point Cluster application of                            magnetic field analysis tools: The Curl- ometer, J. Geophys. Res., 107(A11), 1384,                                                                      doi : <a class="reference external" href="https://doi.org/10.1029/2001JA005088">https://doi.org/10.1029/2001JA005088</a>.</p>
</dd>
<dt class="label" id="raf9a5c45efde-5"><span class="brackets"><a class="fn-backref" href="#id8">5</a></span></dt>
<dd><p>Robert, P., et al. (1998), Accuracy of current determination, in Analysis Methods for Multi-Spacecraft                  Data, edited by G. Paschmann and P. W. Daly, pp. 395–418, Int. Space Sci. Inst., Bern.
url : <a class="reference external" href="http://www.issibern.ch/forads/sr-001-16.pdf">http://www.issibern.ch/forads/sr-001-16.pdf</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mms</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="n">mms_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_mms</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="n">mms_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.c_4_k">
<span id="pyrfu-pyrf-c-4-k-module"></span><h2>pyrfu.pyrf.c_4_k module<a class="headerlink" href="#module-pyrfu.pyrf.c_4_k" title="Permalink to this headline">¶</a></h2>
<p>c_4_k.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.c_4_k.c_4_k">
<code class="sig-prename descclassname">pyrfu.pyrf.c_4_k.</code><code class="sig-name descname">c_4_k</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r_list</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/c_4_k.html#c_4_k"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.c_4_k.c_4_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates reciprocal vectors in barycentric coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Position of the spacecrafts.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>k_list</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Reciprocal vectors in barycentric coordinates.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The units of reciprocal vectors are the same as [1/r].</p>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.c_4_v">
<span id="pyrfu-pyrf-c-4-v-module"></span><h2>pyrfu.pyrf.c_4_v module<a class="headerlink" href="#module-pyrfu.pyrf.c_4_v" title="Permalink to this headline">¶</a></h2>
<p>c_4_v.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.c_4_v.c_4_v">
<code class="sig-prename descclassname">pyrfu.pyrf.c_4_v.</code><code class="sig-name descname">c_4_v</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/c_4_v.html#c_4_v"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.c_4_v.c_4_v" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates velocity or time shift of discontinuity as in <a class="reference internal" href="#rb48e996ef3c9-6" id="id11">[6]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the positions of the spacecraft.</p>
</dd>
<dt><strong>x</strong><span class="classifier">list</span></dt><dd><p>Crossing times or time and velocity.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Discontinuity velocity or time shift with respect to mms1.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rb48e996ef3c9-6"><span class="brackets"><a class="fn-backref" href="#id11">6</a></span></dt>
<dd><p>Vogt, J., Haaland, S., and Paschmann, G. (2011) Accuracy of multi-point boundary crossing time analysis,
Ann. Geophys., 29, 2239-2252, doi : <a class="reference external" href="https://doi.org/10.5194/angeo-29-2239-2011">https://doi.org/10.5194/angeo-29-2239-2011</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrfu.pyrf.c_4_v.get_vol_ten">
<code class="sig-prename descclassname">pyrfu.pyrf.c_4_v.</code><code class="sig-name descname">get_vol_ten</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/c_4_v.html#get_vol_ten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.c_4_v.get_vol_ten" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.calc_disprel_tm">
<span id="pyrfu-pyrf-calc-disprel-tm-module"></span><h2>pyrfu.pyrf.calc_disprel_tm module<a class="headerlink" href="#module-pyrfu.pyrf.calc_disprel_tm" title="Permalink to this headline">¶</a></h2>
<p>calc_disprel_tm.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.calc_disprel_tm.calc_disprel_tm">
<code class="sig-prename descclassname">pyrfu.pyrf.calc_disprel_tm.</code><code class="sig-name descname">calc_disprel_tm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tau</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tau_err</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/calc_disprel_tm.html#calc_disprel_tm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.calc_disprel_tm.calc_disprel_tm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes dispersion relation from velocities and period given by the timing method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>v</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the velocities.</p>
</dd>
<dt><strong>v_err</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the error on velocities.</p>
</dd>
<dt><strong>tau</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the periods.</p>
</dd>
<dt><strong>tau_err</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the error on period.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.Dataset</span></dt><dd><p>DataSet containing the frequency, the wavelength, the wavenumber. Also includes the errors and the fit
(e.g Vph phase velocity).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-pyrfu.pyrf.c_4_v" title="pyrfu.pyrf.c_4_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.pyrf.c_4_v</span></code></a></dt><dd><p>Calculates velocity or time shift of discontinuity.</p>
</dd>
</dl>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.calc_dt">
<span id="pyrfu-pyrf-calc-dt-module"></span><h2>pyrfu.pyrf.calc_dt module<a class="headerlink" href="#module-pyrfu.pyrf.calc_dt" title="Permalink to this headline">¶</a></h2>
<p>calc_dt.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.calc_dt.calc_dt">
<code class="sig-prename descclassname">pyrfu.pyrf.calc_dt.</code><code class="sig-name descname">calc_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/calc_dt.html#calc_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.calc_dt.calc_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes time step of the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">float</span></dt><dd><p>Time step in seconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.calc_fs">
<span id="pyrfu-pyrf-calc-fs-module"></span><h2>pyrfu.pyrf.calc_fs module<a class="headerlink" href="#module-pyrfu.pyrf.calc_fs" title="Permalink to this headline">¶</a></h2>
<p>calc_fs.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.calc_fs.calc_fs">
<code class="sig-prename descclassname">pyrfu.pyrf.calc_fs.</code><code class="sig-name descname">calc_fs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/calc_fs.html#calc_fs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.calc_fs.calc_fs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the sampling frequency of the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">float</span></dt><dd><p>Sampling frequency in Hz.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.cart2sph">
<span id="pyrfu-pyrf-cart2sph-module"></span><h2>pyrfu.pyrf.cart2sph module<a class="headerlink" href="#module-pyrfu.pyrf.cart2sph" title="Permalink to this headline">¶</a></h2>
<p>cart2sph.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.cart2sph.cart2sph">
<code class="sig-prename descclassname">pyrfu.pyrf.cart2sph.</code><code class="sig-name descname">cart2sph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">direction_flag</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/cart2sph.html#cart2sph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.cart2sph.cart2sph" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes magnitude, theta and phi angle from column vector xyz (first column is x ….) theta is 0 at equator.
direction_flag = -1  -&gt; to make transformation in opposite direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series to convert.</p>
</dd>
<dt><strong>direction_flag</strong><span class="classifier">{1, -1}</span></dt><dd><p>Set to 1 (default) to transform from cartesian to spherical coordinates.
Set to -1 to transform from spherical to cartesian coordinates.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input field in spherical/cartesian coordinate system.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.convert_fac">
<span id="pyrfu-pyrf-convert-fac-module"></span><h2>pyrfu.pyrf.convert_fac module<a class="headerlink" href="#module-pyrfu.pyrf.convert_fac" title="Permalink to this headline">¶</a></h2>
<p>convert_fac.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.convert_fac.convert_fac">
<code class="sig-prename descclassname">pyrfu.pyrf.convert_fac.</code><code class="sig-name descname">convert_fac</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_bgd</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">array([1, 0, 0])</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/convert_fac.html#convert_fac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.convert_fac.convert_fac" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Transforms to a field-aligned coordinate (FAC) system defined as :</dt><dd><ul class="simple">
<li><p>R_parallel_z aligned with the background magnetic field</p></li>
<li><p>R_perp_y defined by R_parallel cross the position vector of the spacecraft (nominally eastward at the equator)</p></li>
<li><p>R_perp_x defined by R_perp_y cross R_par</p></li>
</ul>
</dd>
</dl>
<p>If inp is one vector along r direction, out is inp[perp, para] projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field.</p>
</dd>
<dt><strong>b_bgd</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field.</p>
</dd>
<dt><strong>r</strong><span class="classifier">xarray.DataArray or numpy.ndarray or list</span></dt><dd><p>Position vector of spacecraft.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field in field aligned coordinates system.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All input parameters must be in the same coordinate system.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field (FGM) and electric field (EDP)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">convert_fac</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.corr_deriv">
<span id="pyrfu-pyrf-corr-deriv-module"></span><h2>pyrfu.pyrf.corr_deriv module<a class="headerlink" href="#module-pyrfu.pyrf.corr_deriv" title="Permalink to this headline">¶</a></h2>
<p>corr_deriv.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.corr_deriv.corr_deriv">
<code class="sig-prename descclassname">pyrfu.pyrf.corr_deriv.</code><code class="sig-name descname">corr_deriv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fla</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/corr_deriv.html#corr_deriv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.corr_deriv.corr_deriv" title="Permalink to this definition">¶</a></dt>
<dd><p>Correlate the derivatives of two time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x1</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the first to variable to correlate with.</p>
</dd>
<dt><strong>x2</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the second to variable to correlate with.</p>
</dd>
<dt><strong>fla</strong><span class="classifier">bool</span></dt><dd><p>Flag if False (default) returns time instants of common highest first and second derivatives.
If True returns time instants of common highest first derivative and zeros crossings.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>t1_d, t2_d</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Time instants of common highest first derivatives.</p>
</dd>
<dt><strong>t1_dd, t2_dd</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Time instants of common highest second derivatives or zero crossings.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.cross">
<span id="pyrfu-pyrf-cross-module"></span><h2>pyrfu.pyrf.cross module<a class="headerlink" href="#module-pyrfu.pyrf.cross" title="Permalink to this headline">¶</a></h2>
<p>cross.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.cross.cross">
<code class="sig-prename descclassname">pyrfu.pyrf.cross.</code><code class="sig-name descname">cross</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/cross.html#cross"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.cross.cross" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross product of two fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the first field X.</p>
</dd>
<dt><strong>y</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the second field Y.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the cross product Z = XxY.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Index of the MMS spacecraft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute ExB drift velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_xyz_exb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">)</span> <span class="o">/</span> <span class="n">b_mag</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.date_str">
<span id="pyrfu-pyrf-date-str-module"></span><h2>pyrfu.pyrf.date_str module<a class="headerlink" href="#module-pyrfu.pyrf.date_str" title="Permalink to this headline">¶</a></h2>
<p>date_str.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.date_str.date_str">
<code class="sig-prename descclassname">pyrfu.pyrf.date_str.</code><code class="sig-name descname">date_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/date_str.html#date_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.date_str.date_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a string corresponding to time interval for output plot naming.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tint</strong><span class="classifier">list of str</span></dt><dd><p>Time interval.</p>
</dd>
<dt><strong>fmt</strong><span class="classifier">int</span></dt><dd><dl class="simple">
<dt>Format of the output :</dt><dd><ul class="simple">
<li><p>1 : “%Y%m%d_%H%M”</p></li>
<li><p>2 : “%y%m%d%H%M%S”</p></li>
<li><p>3 : “%Y%m%d_%H%M%S”_”%H%M%S”</p></li>
<li><p>4 : “%Y%m%d_%H%M%S”_”%Y%m%d_%H%M%S”</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">str</span></dt><dd><p>String corresponding to the time interval in the desired format.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.dec_par_perp">
<span id="pyrfu-pyrf-dec-par-perp-module"></span><h2>pyrfu.pyrf.dec_par_perp module<a class="headerlink" href="#module-pyrfu.pyrf.dec_par_perp" title="Permalink to this headline">¶</a></h2>
<p>dec_par_perp.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.dec_par_perp.dec_par_perp">
<code class="sig-prename descclassname">pyrfu.pyrf.dec_par_perp.</code><code class="sig-name descname">dec_par_perp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag_spin_plane</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/dec_par_perp.html#dec_par_perp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.dec_par_perp.dec_par_perp" title="Permalink to this definition">¶</a></dt>
<dd><p>Decomposes a vector into par/perp to B components. If flagspinplane decomposes components to the projection of B
into the XY plane. Alpha_XY gives the angle between B0 and the XY plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the field to decompose.</p>
</dd>
<dt><strong>b0</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field.</p>
</dd>
<dt><strong>flag_spin_plane</strong><span class="classifier">bool, optional</span></dt><dd><p>Flag if True gives the projection in XY plane.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>a_para</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field parallel to the background magnetic field.</p>
</dd>
<dt><strong>a_perp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field perpendicular to the background magnetic field.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the angle between the background magnetic field and the XY plane.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field (FGM) and electric field (EDP)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Decompose e_xyz into parallel and perpendicular to b_xyz components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_para</span><span class="p">,</span> <span class="n">e_perp</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">dec_par_perp</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.disp_surf_calc">
<span id="pyrfu-pyrf-disp-surf-calc-module"></span><h2>pyrfu.pyrf.disp_surf_calc module<a class="headerlink" href="#module-pyrfu.pyrf.disp_surf_calc" title="Permalink to this headline">¶</a></h2>
<p>dispersion_surface_calc.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.disp_surf_calc.dispersion_surface_calc">
<code class="sig-prename descclassname">pyrfu.pyrf.disp_surf_calc.</code><code class="sig-name descname">dispersion_surface_calc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kc_x_max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kc_z_max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_i</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_pe</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/disp_surf_calc.html#dispersion_surface_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.disp_surf_calc.dispersion_surface_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the cold plasma dispersion surfaces according to equation 2.64 in Plasma Waves by Swanson (2nd ed.),
and puts them in the matrix W. Additional parameters that are needed in dispersion_surface is returned as
extra_param.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kc_x_max</strong><span class="classifier">float or int</span></dt><dd><p>Max value of k_perpendicular*c/w_c.</p>
</dd>
<dt><strong>kc_z_max</strong><span class="classifier">float or int</span></dt><dd><p>Max value of k_parallel*c/w_c.</p>
</dd>
<dt><strong>m_i</strong><span class="classifier">float</span></dt><dd><p>Ion mass in terms of electron masses.</p>
</dd>
<dt><strong>w_pe</strong><span class="classifier">float</span></dt><dd><p>Electron plasma frequency in terms of electron gyro frequency.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w_final</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>to fill.</p>
</dd>
<dt><strong>extra_param</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>to fill.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is essential for dispersion_surface to work.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.dist_append">
<span id="pyrfu-pyrf-dist-append-module"></span><h2>pyrfu.pyrf.dist_append module<a class="headerlink" href="#module-pyrfu.pyrf.dist_append" title="Permalink to this headline">¶</a></h2>
<p>dist_append.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.dist_append.dist_append">
<code class="sig-prename descclassname">pyrfu.pyrf.dist_append.</code><code class="sig-name descname">dist_append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/dist_append.html#dist_append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.dist_append.dist_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate two distribution skymaps along the time axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp0</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>3D skymap distribution at early times.</p>
</dd>
<dt><strong>inp1</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>3D skymap distribution at late times.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>3D skymap of the concatenated 3D skymaps.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The time series have to be in the correct time order.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.dot">
<span id="pyrfu-pyrf-dot-module"></span><h2>pyrfu.pyrf.dot module<a class="headerlink" href="#module-pyrfu.pyrf.dot" title="Permalink to this headline">¶</a></h2>
<p>dot.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.dot.dot">
<code class="sig-prename descclassname">pyrfu.pyrf.dot.</code><code class="sig-name descname">dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/dot.html#dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.dot.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes dot product of two fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the first field X.</p>
</dd>
<dt><strong>y</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the second field Y.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the dot product Z = X.Y.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_list</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, electric field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">,</span> <span class="n">e_mms</span> <span class="o">=</span> <span class="p">[[]</span> <span class="o">*</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="n">mms_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">r_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">b_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">e_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_xyz</span><span class="p">,</span> <span class="n">div_b</span><span class="p">,</span> <span class="n">b_avg</span><span class="p">,</span> <span class="n">jxb</span><span class="p">,</span> <span class="n">div_t_shear</span><span class="p">,</span> <span class="n">div_pb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the electric at the center of mass of the tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">avg_4sc</span><span class="p">(</span><span class="n">e_mms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute J.E dissipation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">je</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">j_xyz</span><span class="p">,</span> <span class="n">e_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.dynamic_press">
<span id="pyrfu-pyrf-dynamic-press-module"></span><h2>pyrfu.pyrf.dynamic_press module<a class="headerlink" href="#module-pyrfu.pyrf.dynamic_press" title="Permalink to this headline">¶</a></h2>
<p>dynamic_press.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.dynamic_press.dynamic_press">
<code class="sig-prename descclassname">pyrfu.pyrf.dynamic_press.</code><code class="sig-name descname">dynamic_press</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">'i'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/dynamic_press.html#dynamic_press"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.dynamic_press.dynamic_press" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes dynamic pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the number density of the specie.</p>
</dd>
<dt><strong>v</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the bulk velocity of the specie.</p>
</dd>
<dt><strong>s</strong><span class="classifier">{“i”, “e”}, optional</span></dt><dd><p>Specie. default “i”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>p_dyn</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the dynamic pressure of the specie.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load ion bulk velocity and remove spintone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_xyz_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Vi_gse_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_xyz_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;STi_gse_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_xyz_i</span> <span class="o">=</span> <span class="n">v_xyz_i</span> <span class="o">-</span> <span class="n">st_xyz_i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ion number density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ni_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute dynamic pressure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">dynamic_press</span><span class="p">(</span><span class="n">n_i</span><span class="p">,</span> <span class="n">v_xyz_i</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.e_vxb">
<span id="pyrfu-pyrf-e-vxb-module"></span><h2>pyrfu.pyrf.e_vxb module<a class="headerlink" href="#module-pyrfu.pyrf.e_vxb" title="Permalink to this headline">¶</a></h2>
<p>e_vxb.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.e_vxb.e_vxb">
<code class="sig-prename descclassname">pyrfu.pyrf.e_vxb.</code><code class="sig-name descname">e_vxb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag</span><span class="o">=</span><span class="default_value">'vxb'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/e_vxb.html#e_vxb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.e_vxb.e_vxb" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the convection electric field <span class="math notranslate nohighlight">\(\mathbf{V}\times\mathbf{B}\)</span> (default) or the
<span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}/|\mathbf{B}|^{2}\)</span> drift velocity (flag=”exb”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>v</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the velocity/electric field.</p>
</dd>
<dt><strong>b</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field.</p>
</dd>
<dt><strong>flag</strong><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Method flag :</dt><dd><ul class="simple">
<li><p>“vxb” : computes convection electric field (default).</p></li>
<li><p>“exb” : computes ExB drift velocity.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the convection electric field/ExB drift velocity.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute ExB drift velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_xyz_exb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">e_vxb</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span><span class="s2">&quot;ExB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.eb_nrf">
<span id="pyrfu-pyrf-eb-nrf-module"></span><h2>pyrfu.pyrf.eb_nrf module<a class="headerlink" href="#module-pyrfu.pyrf.eb_nrf" title="Permalink to this headline">¶</a></h2>
<p>eb_nrf.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.eb_nrf.eb_nrf">
<code class="sig-prename descclassname">pyrfu.pyrf.eb_nrf.</code><code class="sig-name descname">eb_nrf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/eb_nrf.html#eb_nrf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.eb_nrf.eb_nrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Find E and B in MP system given B and MP normal vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electric field.</p>
</dd>
<dt><strong>b</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field.</p>
</dd>
<dt><strong>v</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Normal vector.</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int or numpy.ndarray</span></dt><dd><p>to fill.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">DataArray</span></dt><dd><p>to fill.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ebsp">
<span id="pyrfu-pyrf-ebsp-module"></span><h2>pyrfu.pyrf.ebsp module<a class="headerlink" href="#module-pyrfu.pyrf.ebsp" title="Permalink to this headline">¶</a></h2>
<p>ebsp.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ebsp.average_data">
<code class="sig-prename descclassname">pyrfu.pyrf.ebsp.</code><code class="sig-name descname">average_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">av_window</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ebsp.html#average_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ebsp.average_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrfu.pyrf.ebsp.ebsp">
<code class="sig-prename descclassname">pyrfu.pyrf.ebsp.</code><code class="sig-name descname">ebsp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">db</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">full_b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">freq_int</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ebsp.html#ebsp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ebsp.ebsp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates wavelet spectra of E&amp;B and Poynting flux using wavelets (Morlet wavelet). Also computes polarization
parameters of B using SVD <a class="reference internal" href="#re0a53a669748-7" id="id13">[7]</a>. SVD is performed on spectral matrices computed from the time series of B using wavelets
and then averaged over a number of wave periods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the wave electric field.</p>
</dd>
<dt><strong>db</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the wave magnetic field.</p>
</dd>
<dt><strong>full_b</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the high resolution background magnetic field used for E.B=0.</p>
</dd>
<dt><strong>b0</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field used for field aligned coordinates.</p>
</dd>
<dt><strong>xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the position time series of spacecraft used for field aligned coordinates.</p>
</dd>
<dt><strong>freq_int</strong><span class="classifier">str or list or numpy.ndarray</span></dt><dd><dl class="simple">
<dt>Frequency interval :</dt><dd><ul class="simple">
<li><p>“pc12” : [0.1, 5.0]</p></li>
<li><p>“pc35” : [2e-3, 0.1]</p></li>
<li><p>[fmin, fmax] : arbitrary interval [fmin,fmax]</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Hash table of keyword arguments with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>polarization<span class="classifier">bool</span></dt><dd><p>Computes polarization parameters. Default False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>noresamp<span class="classifier">bool</span></dt><dd><p>No resampling, E and db are given at the same time line Default False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>fac<span class="classifier">bool</span></dt><dd><p>Uses FAC coordinate system (defined by b0 and optionally xyz), otherwise no coordinate system
transformation is performed. Default False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>de_dot_b0<span class="classifier">bool</span></dt><dd><p>Computes dEz from db dot B = 0, uses full_b. Default False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>full_b_db<span class="classifier">bool</span></dt><dd><p>db contains DC field. Default False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nav<span class="classifier">int</span></dt><dd><p>Number of wave periods to average Default 8.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>fac_matrix<span class="classifier">numpy.ndarray</span></dt><dd><p>Specify rotation matrix to FAC system Default None.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>m_width_coeff<span class="classifier">int or float</span></dt><dd><p>Specify coefficient to multiple Morlet wavelet width by. Default 1.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>res</strong><span class="classifier">xarray.Dataset</span></dt><dd><dl class="simple">
<dt>Dataset with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>t<span class="classifier">xarray.DataArray</span></dt><dd><p>Time.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>f<span class="classifier">xarray.DataArray</span></dt><dd><p>Frequencies.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bb_xxyyzzss<span class="classifier">xarray.DataArray</span></dt><dd><dl class="simple">
<dt>db power spectrum with :</dt><dd><ul>
<li><p>[…,0] : x</p></li>
<li><p>[…,1] : y</p></li>
<li><p>[…,2] : z</p></li>
<li><p>[…,3] : sum</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ee_xxyyzzss<span class="classifier">xarray.DataArray</span></dt><dd><dl class="simple">
<dt>E power spectrum with :</dt><dd><ul>
<li><p>[…,0] : x</p></li>
<li><p>[…,1] : y</p></li>
<li><p>[…,2] : z</p></li>
<li><p>[…,3] : sum</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ee_ss<span class="classifier">xarray.DataArray</span></dt><dd><p>E power spectrum (xx+yy spacecraft coordinates, e.g. ISR2).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pf_xyz<span class="classifier">xarray.DataArray</span></dt><dd><p>Poynting flux (xyz).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pf_rtp<span class="classifier">xarray.DataArray</span></dt><dd><p>Poynting flux (r, theta, phi) [angles in degrees].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dop<span class="classifier">xarray.DataArray</span></dt><dd><p>3D degree of polarization.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dop2d<span class="classifier">xarray.DataArray</span></dt><dd><p>2D degree of polarization in the polarization plane.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>planarity<span class="classifier">xarray.DataArray</span></dt><dd><p>Planarity of polarization.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ellipticity<span class="classifier">xarray.DataArray</span></dt><dd><p>Ellipticity of polarization ellipse.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>k<span class="classifier">xarray.DataArray</span></dt><dd><p>k-vector (theta, phi FAC) [angles in degrees].</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.plot.pl_ebsp</span></code></dt><dd><p>to fill.</p>
</dd>
<dt><a class="reference internal" href="#module-pyrfu.pyrf.convert_fac" title="pyrfu.pyrf.convert_fac"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.pyrf.convert_fac</span></code></a></dt><dd><p>Transforms to a field-aligned coordinate.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This software was developed as part of the MAARBLE (Monitoring, Analyzing and Assessing Radiation Belt
Energization and Loss) collaborative research project which has received funding from the European
Community’s Seventh Framework Programme (FP7-SPACE-2011-1) under grant agreement n. 284520.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="re0a53a669748-7"><span class="brackets"><a class="fn-backref" href="#id13">7</a></span></dt>
<dd><p>Santolík, O., Parrot. M., and  Lefeuvre. F. (2003) Singular value decomposition methods for wave propagation
analysis,Radio Sci., 38(1), 1010, doi : <a class="reference external" href="https://doi.org/10.1029/2000RS002523">https://doi.org/10.1029/2000RS002523</a> .</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint_brst</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:42.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-10-30T05:15:54.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint_long</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">extend_tint</span><span class="p">(</span><span class="n">tint_brst</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint_long</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load background magnetic field, electric field and magnetic field fluctuations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint_brst</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint_brst</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_scm</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_scm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint_brst</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Polarization analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarization</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">ebsp</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_scm</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">r_xyz</span><span class="p">,</span> <span class="n">freq_int</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4000</span><span class="p">],</span> <span class="n">polarization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.edb">
<span id="pyrfu-pyrf-edb-module"></span><h2>pyrfu.pyrf.edb module<a class="headerlink" href="#module-pyrfu.pyrf.edb" title="Permalink to this headline">¶</a></h2>
<p>edb.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.edb.edb">
<code class="sig-prename descclassname">pyrfu.pyrf.edb.</code><code class="sig-name descname">edb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">angle_lim</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">flag_method</span><span class="o">=</span><span class="default_value">'E.B=0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/edb.html#edb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.edb.edb" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Ez under assumption <span class="math notranslate nohighlight">\(\mathbf{E}.\mathbf{B}=0\)</span> or <span class="math notranslate nohighlight">\(\mathbf{E}.\mathbf{B} \approx 0\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electric field.</p>
</dd>
<dt><strong>b0</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field.</p>
</dd>
<dt><strong>flag_method</strong><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Assumption on the direction of the measured electric field :</dt><dd><p>“e.b=0” :  <span class="math notranslate nohighlight">\(\mathbf{E}.\mathbf{B}=0\)</span>.
“e_par” :  <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> field along the B projection is coming from parallel electric field.
“e_perp+nan” : to fill.</p>
</dd>
</dl>
</dd>
<dt><strong>angle_lim</strong><span class="classifier">float</span></dt><dd><p>B angle with respect to the spin plane should be less than angle_lim degrees otherwise Ez is set to 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ed</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electric field output.</p>
</dd>
<dt><strong>d</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the B elevation angle above spin plane.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, electric field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute Ez</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_z</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">edb</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.end">
<span id="pyrfu-pyrf-end-module"></span><h2>pyrfu.pyrf.end module<a class="headerlink" href="#module-pyrfu.pyrf.end" title="Permalink to this headline">¶</a></h2>
<p>end.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.end.end">
<code class="sig-prename descclassname">pyrfu.pyrf.end.</code><code class="sig-name descname">end</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/end.html#end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.end.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the last time of the time series in unix format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">float or str</span></dt><dd><p>Value of the last time in the desired format.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.extend_tint">
<span id="pyrfu-pyrf-extend-tint-module"></span><h2>pyrfu.pyrf.extend_tint module<a class="headerlink" href="#module-pyrfu.pyrf.extend_tint" title="Permalink to this headline">¶</a></h2>
<p>extend_tint.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.extend_tint.extend_tint">
<code class="sig-prename descclassname">pyrfu.pyrf.extend_tint.</code><code class="sig-name descname">extend_tint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/extend_tint.html#extend_tint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.extend_tint.extend_tint" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends time interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tint</strong><span class="classifier">list of str</span></dt><dd><p>Reference time interval to extend.</p>
</dd>
<dt><strong>ext</strong><span class="classifier">list of float or int</span></dt><dd><p>Number of seconds to extend time interval [left extend, right extend].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tint</strong><span class="classifier">list of str</span></dt><dd><p>Extended time interval.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:42.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-10-30T05:15:54.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint_long</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">extend_tint</span><span class="p">(</span><span class="n">tint</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.filt">
<span id="pyrfu-pyrf-filt-module"></span><h2>pyrfu.pyrf.filt module<a class="headerlink" href="#module-pyrfu.pyrf.filt" title="Permalink to this headline">¶</a></h2>
<p>filt.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.filt.filt">
<code class="sig-prename descclassname">pyrfu.pyrf.filt.</code><code class="sig-name descname">filt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">f_min</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">f_max</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/filt.html#filt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.filt.filt" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters input quantity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the variable to filter.</p>
</dd>
<dt><strong>f_min</strong><span class="classifier">float</span></dt><dd><p>Lower limit of the frequency range.</p>
</dd>
<dt><strong>f_max</strong><span class="classifier">float</span></dt><dd><p>Upper limit of the frequency range.</p>
</dd>
<dt><strong>n</strong><span class="classifier">int</span></dt><dd><p>Order of the elliptic filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the filtered signal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2017-07-18T13:03:34.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-07-18T13:07:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic and electric fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert E to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">convert_fac</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bandpass filter E waveform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyzfac_hf</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">e_xyzfac</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyzfac_lf</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">e_xyzfac</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.find_closest">
<span id="pyrfu-pyrf-find-closest-module"></span><h2>pyrfu.pyrf.find_closest module<a class="headerlink" href="#module-pyrfu.pyrf.find_closest" title="Permalink to this headline">¶</a></h2>
<p>find_closest.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.find_closest.find_closest">
<code class="sig-prename descclassname">pyrfu.pyrf.find_closest.</code><code class="sig-name descname">find_closest</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t2</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/find_closest.html#find_closest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.find_closest.find_closest" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds pairs that are closest to each other in two time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t1</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vector with time instants.</p>
</dd>
<dt><strong>t2</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vector with time instants.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>t1new</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Identified time instants that are closest each other.</p>
</dd>
<dt><strong>t2new</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Identified time instants that are closest each other.</p>
</dd>
<dt><strong>ind1new</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Identified time instants that are closest each other.</p>
</dd>
<dt><strong>ind2new</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Identified time instants that are closest each other.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.generic_minimum_residue_analysis">
<span id="pyrfu-pyrf-generic-minimum-residue-analysis-module"></span><h2>pyrfu.pyrf.generic_minimum_residue_analysis module<a class="headerlink" href="#module-pyrfu.pyrf.generic_minimum_residue_analysis" title="Permalink to this headline">¶</a></h2>
<p>.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.generic_minimum_residue_analysis.generic_minimum_residue_analysis_engine">
<code class="sig-prename descclassname">pyrfu.pyrf.generic_minimum_residue_analysis.</code><code class="sig-name descname">generic_minimum_residue_analysis_engine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constraint_vector</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/generic_minimum_residue_analysis.html#generic_minimum_residue_analysis_engine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.generic_minimum_residue_analysis.generic_minimum_residue_analysis_engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates L, V and U given the density of conserved quantity eta and transport tensor q using constraint that
discontinuity normal is perpendicular to the constraint vector.</p>
<p>Implements general Generic Minimum Residue Analysis (GMRA) solution based on <a class="reference internal" href="#rfea98ee1cfb8-8" id="id15">[8]</a>, <a class="reference internal" href="#rfea98ee1cfb8-9" id="id16">[9]</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>eta</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Density of conserved quantity Mx3, M is number of points</p>
</dd>
<dt><strong>q</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Transport tensor</p>
</dd>
<dt><strong>constraint_vector</strong><span class="classifier">list or numpy.ndarray</span></dt><dd><p>Constraint vector</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>l :</dt><dd><p>Eigenvalues</p>
</dd>
<dt>v :</dt><dd><p>Eigenvectors corresponding to lmin, lmean, lmax</p>
</dd>
<dt>u :</dt><dd><p>Transport velocity, boundary velocity is Un = U * V(:, 1)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rfea98ee1cfb8-8"><span class="brackets"><a class="fn-backref" href="#id15">8</a></span></dt>
<dd><p>Sonnerup, B. U. Ö., S. Haaland, G. Paschmann, M. W. Dunlop, H. Rème, and A. Balogh (2006), Orientation
and motion ofa plasma discontinuity from single-spacecraft measurements: Generic residue analysis of
Cluster data, J. Geophys. Res., 111, A05203,doi : <a class="reference external" href="https://doi.org/10.1029/2005JA011538">https://doi.org/10.1029/2005JA011538</a> .</p>
</dd>
<dt class="label" id="rfea98ee1cfb8-9"><span class="brackets"><a class="fn-backref" href="#id16">9</a></span></dt>
<dd><p>Sonnerup, B. U. Ö., S. Haaland, G. Paschmann, M. W. Dunlop, H. Rème, and A. Balogh (2007), Correction to
‘Orientationand motion of a plasma discontinuity from single-spacecraft measurements: Generic residue
analysis of Cluster data,’ J. Geophys.Res., 11 2 , A04201, doi : hhtps://doi.org/10.1029/2007JA012288 .</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.gradient">
<span id="pyrfu-pyrf-gradient-module"></span><h2>pyrfu.pyrf.gradient module<a class="headerlink" href="#module-pyrfu.pyrf.gradient" title="Permalink to this headline">¶</a></h2>
<p>gradient.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.gradient.gradient">
<code class="sig-prename descclassname">pyrfu.pyrf.gradient.</code><code class="sig-name descname">gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/gradient.html#gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.gradient.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes time derivative of the input variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the time derivative of the input variable.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2017-07-18T13:03:34.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-07-18T13:07:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time derivative of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_dt</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.histogram">
<span id="pyrfu-pyrf-histogram-module"></span><h2>pyrfu.pyrf.histogram module<a class="headerlink" href="#module-pyrfu.pyrf.histogram" title="Permalink to this headline">¶</a></h2>
<p>histogram.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.histogram.histogram">
<code class="sig-prename descclassname">pyrfu.pyrf.histogram.</code><code class="sig-name descname">histogram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">normed</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/histogram.html#histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.histogram.histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes 1D histogram of the inp with bins bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input scalar variable.</p>
</dd>
<dt><strong>bins</strong><span class="classifier">int</span></dt><dd><p>Number of bins.</p>
</dd>
<dt><strong>normed</strong><span class="classifier">bool</span></dt><dd><p>Normalize the PDF.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>1D distribution of the input time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.histogram2d">
<span id="pyrfu-pyrf-histogram2d-module"></span><h2>pyrfu.pyrf.histogram2d module<a class="headerlink" href="#module-pyrfu.pyrf.histogram2d" title="Permalink to this headline">¶</a></h2>
<p>histogram2d.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.histogram2d.histogram2d">
<code class="sig-prename descclassname">pyrfu.pyrf.histogram2d.</code><code class="sig-name descname">histogram2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/histogram2d.html#histogram2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.histogram2d.histogram2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes 2d histogram of inp2 vs inp1 with nbins number of bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp1</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the x values.</p>
</dd>
<dt><strong>inp2</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the y values.</p>
</dd>
<dt><strong>bins</strong><span class="classifier">int</span></dt><dd><p>Number of bins.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>2D map of the density of inp2 vs inp1.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_xyz</span><span class="p">,</span> <span class="n">div_b</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">jxb</span><span class="p">,</span> <span class="n">div_t_shear</span><span class="p">,</span> <span class="n">div_pb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of B and J</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">j_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Histogram of |J| vs |B|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2d_b_j</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">b_mag</span><span class="p">,</span> <span class="n">j_mag</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.increments">
<span id="pyrfu-pyrf-increments-module"></span><h2>pyrfu.pyrf.increments module<a class="headerlink" href="#module-pyrfu.pyrf.increments" title="Permalink to this headline">¶</a></h2>
<p>increments.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.increments.increments">
<code class="sig-prename descclassname">pyrfu.pyrf.increments.</code><code class="sig-name descname">increments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/increments.html#increments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.increments.increments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the increments of a time series.</p>
<div class="math notranslate nohighlight">
\[y = |x_i - x_{i+s}|\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is the scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input time series.</p>
</dd>
<dt><strong>scale</strong><span class="classifier">int</span></dt><dd><p>Scale at which to compute the increments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>kurt</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>kurtosis of the increments, one per product, using the Fisher’s
definition (0 value for a normal distribution).</p>
</dd>
<dt><strong>result</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>An xarray containing the time series increments, one per
product in the original time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.int_sph_dist">
<span id="pyrfu-pyrf-int-sph-dist-module"></span><h2>pyrfu.pyrf.int_sph_dist module<a class="headerlink" href="#module-pyrfu.pyrf.int_sph_dist" title="Permalink to this headline">¶</a></h2>
<p>int_sph_dist.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.int_sph_dist.int_sph_dist">
<code class="sig-prename descclassname">pyrfu.pyrf.int_sph_dist.</code><code class="sig-name descname">int_sph_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">vg</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/int_sph_dist.html#int_sph_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.int_sph_dist.int_sph_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the integrated distribution function of a 3D distribution function in a spherical grid. F is a 3D 
matrix containing values of the flux (index order of F is [velocity,phi,th]), phi is the azimuthal and th the 
elevation angles in radians, and vg is the .</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>F<span class="classifier">array</span></dt><dd><p>3D skymap of the distribution function</p>
</dd>
<dt>v<span class="classifier">array</span></dt><dd><p>Velocity</p>
</dd>
<dt>ph<span class="classifier">array</span></dt><dd><p>Azimuthal angle</p>
</dd>
<dt>th<span class="classifier">array</span></dt><dd><p>Elevation angle</p>
</dd>
<dt>vg<span class="classifier">array</span></dt><dd><p>Bin centers of the velocity of the projection grid</p>
</dd>
</dl>
</dd>
<dt>Options:</dt><dd><dl class="simple">
<dt>phig<span class="classifier">array</span></dt><dd><p>Bin centers of the azimuthal angle of the projection in radians in the span [0,2*pi]. If this input is 
given, the projection will be 2D. If it is omitted, the projection will be 1D.c</p>
</dd>
<dt>x<span class="classifier">list/array</span></dt><dd><p>Axis that is not integrated along in 1D and x-axis (phig = 0) in 2D. x = [1,0,0] if omitted.</p>
</dd>
<dt>z<span class="classifier">list/array</span></dt><dd><p>Axis that is integrated along in 2D. z = [0,0,1] if omitted.</p>
</dd>
<dt>nMC<span class="classifier">int</span></dt><dd><p>Average number of Monte Carlo iterations used per bin for integration, default is 10. Number of iterations 
can be weighted data value in each bin.</p>
</dd>
<dt>weight<span class="classifier">str</span></dt><dd><p>How the number of MC iterations per bin is weighted, can be None (default), “lin” or “log”</p>
</dd>
<dt>vzint<span class="classifier">list of float</span></dt><dd><p>Set limits on the out-of-plane velocity interval in 2D and “transverse” velocity in 1D.</p>
</dd>
<dt>aint<span class="classifier">list of float</span></dt><dd><p>Angular limit in degrees, can be combined with vzlim</p>
</dd>
<dt>base<span class="classifier">str</span></dt><dd><p>coordinate base, ‘pol’ for polar or ‘cart’ for Cartesian, does not matter in 1D case</p>
</dd>
<dt>ve<span class="classifier">list of float</span></dt><dd><p>Velocity edges of instrument (from delta_energy) with same units as v and one element longer than v</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the projected distribution function</p>
</dd>
</dl>
</dd>
<dt>Notes :</dt><dd><p>The function goes through all instrument bins and finds the best match on the projection bin. The value in 
the projection bin, F, is updated as F = F+f*dTau/dA, where f is the instrument value in the bin, dTau is the 
volume element in velocity space of the instrument bin and dA is the area or line element in the projection 
bin. An instrument bin can actually cover several projection bin and the value should be added to all those 
bins, scaled to the area the instrument bin covers of a given projection bin. This area is calculated with a 
Monte Carlo integration scheme, where many “particles” are generated somewhere inside the instrument bin, each 
assigned a fraction of f. The “particles” are then projected onto the line or plane.</p>
</dd>
<dt>See also: </dt><dd><p>mms.plot_int_projection</p>
</dd>
<dt>TODO<span class="classifier"></span></dt><dd><p>Optimization</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.integrate">
<span id="pyrfu-pyrf-integrate-module"></span><h2>pyrfu.pyrf.integrate module<a class="headerlink" href="#module-pyrfu.pyrf.integrate" title="Permalink to this headline">¶</a></h2>
<p>integrate.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.integrate.integrate">
<code class="sig-prename descclassname">pyrfu.pyrf.integrate.</code><code class="sig-name descname">integrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_step</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/integrate.html#integrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.integrate.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the variable to integrate.</p>
</dd>
<dt><strong>time_step</strong><span class="classifier">float</span></dt><dd><p>Time steps threshold. All time_steps larger than 3*time_step are assumed data gaps, default is that
time_step is the smallest value of all time_steps of the time series.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the time integrated input.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-12-14T01:17:40.200&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-12-14T01:17:41.500&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert electric field to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">convert_fac</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.iso2unix">
<span id="pyrfu-pyrf-iso2unix-module"></span><h2>pyrfu.pyrf.iso2unix module<a class="headerlink" href="#module-pyrfu.pyrf.iso2unix" title="Permalink to this headline">¶</a></h2>
<p>iso2unix.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.iso2unix.iso2unix">
<code class="sig-prename descclassname">pyrfu.pyrf.iso2unix.</code><code class="sig-name descname">iso2unix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/iso2unix.html#iso2unix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.iso2unix.iso2unix" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts time in iso format to unix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">list of str</span></dt><dd><p>Time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">list of float</span></dt><dd><p>Time in unix format.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.lowpass">
<span id="pyrfu-pyrf-lowpass-module"></span><h2>pyrfu.pyrf.lowpass module<a class="headerlink" href="#module-pyrfu.pyrf.lowpass" title="Permalink to this headline">¶</a></h2>
<p>lowpass.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.lowpass.lowpass">
<code class="sig-prename descclassname">pyrfu.pyrf.lowpass.</code><code class="sig-name descname">lowpass</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">f_cut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fhz</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/lowpass.html#lowpass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.lowpass.lowpass" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the data through low or highpass filter with max frequency f_cut and subtract from the original.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
<dt><strong>f_cut</strong><span class="classifier">float</span></dt><dd><p>Cutoff frequency.</p>
</dd>
<dt><strong>fhz</strong><span class="classifier">float</span></dt><dd><p>Sampling frequency.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the filter data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.mean">
<span id="pyrfu-pyrf-mean-module"></span><h2>pyrfu.pyrf.mean module<a class="headerlink" href="#module-pyrfu.pyrf.mean" title="Permalink to this headline">¶</a></h2>
<p>mean.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.mean.mean">
<code class="sig-prename descclassname">pyrfu.pyrf.mean.</code><code class="sig-name descname">mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/mean.html#mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.mean.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Put inp into mean field coordinates defined by position vector r and magnetic field b
if earth magnetic dipole axis z is given then uses another algorithm (good for auroral passages)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input field to put into MF coordinates.</p>
</dd>
<dt><strong>r</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the spacecraft position.</p>
</dd>
<dt><strong>b</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field.</p>
</dd>
<dt><strong>z</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Earth magnetic dipole axis.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input field in mean field coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.mean_bins">
<span id="pyrfu-pyrf-mean-bins-module"></span><h2>pyrfu.pyrf.mean_bins module<a class="headerlink" href="#module-pyrfu.pyrf.mean_bins" title="Permalink to this headline">¶</a></h2>
<p>mean_bins.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.mean_bins.mean_bins">
<code class="sig-prename descclassname">pyrfu.pyrf.mean_bins.</code><code class="sig-name descname">mean_bins</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/mean_bins.html#mean_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.mean_bins.mean_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes mean of values of y corresponding to bins of x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the quantity of bins.</p>
</dd>
<dt><strong>y</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the quantity to the mean.</p>
</dd>
<dt><strong>bins</strong><span class="classifier">int</span></dt><dd><p>Number of bins.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.Dataset</span></dt><dd><dl class="simple">
<dt>Dataset with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>bins<span class="classifier">xarray.DataArray</span></dt><dd><p>bin values of the x variable.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>data<span class="classifier">xarray.DataArray</span></dt><dd><p>Mean values of y corresponding to each bin of x.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sigma<span class="classifier">xarray.DataArray</span></dt><dd><p>Standard deviation.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_list</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span> <span class="o">=</span> <span class="p">[[]</span> <span class="o">*</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">r_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">b_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_xyz</span><span class="p">,</span> <span class="n">div_b</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">jxb</span><span class="p">,</span> <span class="n">div_t_shear</span><span class="p">,</span> <span class="n">div_pb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of B and J</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">j_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Mean value of |J| for 10 bins of |B|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_b_j</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">mean_bins</span><span class="p">(</span><span class="n">b_mag</span><span class="p">,</span> <span class="n">j_mag</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.medfilt">
<span id="pyrfu-pyrf-medfilt-module"></span><h2>pyrfu.pyrf.medfilt module<a class="headerlink" href="#module-pyrfu.pyrf.medfilt" title="Permalink to this headline">¶</a></h2>
<p>medfilt.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.medfilt.medfilt">
<code class="sig-prename descclassname">pyrfu.pyrf.medfilt.</code><code class="sig-name descname">medfilt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_pts</span><span class="o">=</span><span class="default_value">11</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/medfilt.html#medfilt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.medfilt.medfilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a median filter over npts points to inp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
<dt><strong>n_pts</strong><span class="classifier">float or int</span></dt><dd><p>Number of points of median filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArry</span></dt><dd><p>Time series of the median filtered input variable.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_list</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span> <span class="o">=</span> <span class="p">[[]</span> <span class="o">*</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">r_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">b_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_xyz</span><span class="p">,</span> <span class="n">div_b</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">jxb</span><span class="p">,</span> <span class="n">div_t_shear</span><span class="p">,</span> <span class="n">div_pb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get J sampling frequency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">calc_fs</span><span class="p">(</span><span class="n">j_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Median filter over 1s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_xyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">medfilt</span><span class="p">(</span><span class="n">j_xyz</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.median_bins">
<span id="pyrfu-pyrf-median-bins-module"></span><h2>pyrfu.pyrf.median_bins module<a class="headerlink" href="#module-pyrfu.pyrf.median_bins" title="Permalink to this headline">¶</a></h2>
<p>median_bins.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.median_bins.median_bins">
<code class="sig-prename descclassname">pyrfu.pyrf.median_bins.</code><code class="sig-name descname">median_bins</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/median_bins.html#median_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.median_bins.median_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes median of values of y corresponding to bins of x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the quantity of bins.</p>
</dd>
<dt><strong>y</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the quantity to the median.</p>
</dd>
<dt><strong>bins</strong><span class="classifier">int</span></dt><dd><p>Number of bins.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.Dataset</span></dt><dd><dl class="simple">
<dt>Dataset with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>bins<span class="classifier">xarray.DataArray</span></dt><dd><p>bin values of the x variable.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>data<span class="classifier">xarray.DataArray</span></dt><dd><p>Median values of y corresponding to each bin of x.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sigma<span class="classifier">xarray.DataArray</span></dt><dd><p>Standard deviation.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_list</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span> <span class="o">=</span> <span class="p">[[]</span> <span class="o">*</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mms_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">r_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">b_mms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_xyz</span><span class="p">,</span> <span class="n">div_b</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="n">jxb</span><span class="p">,</span> <span class="n">div_t_shear</span><span class="p">,</span> <span class="n">div_pb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">r_mms</span><span class="p">,</span> <span class="n">b_mms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of B and J</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">j_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Median value of |J| for 10 bins of |B|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">med_b_j</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">mean_bins</span><span class="p">(</span><span class="n">b_mag</span><span class="p">,</span> <span class="n">j_mag</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.movmean">
<span id="pyrfu-pyrf-movmean-module"></span><h2>pyrfu.pyrf.movmean module<a class="headerlink" href="#module-pyrfu.pyrf.movmean" title="Permalink to this headline">¶</a></h2>
<p>movmean.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.movmean.movmean">
<code class="sig-prename descclassname">pyrfu.pyrf.movmean.</code><code class="sig-name descname">movmean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_pts</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/movmean.html#movmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.movmean.movmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes running average of the inp over npts points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable.</p>
</dd>
<dt><strong>n_pts</strong><span class="classifier">int</span></dt><dd><p>Number of points to average over.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input variable averaged over npts points.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Works also with 3D skymap distribution.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load ion pressure tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_xyz_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Pi_gse_fpi_brst_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Running average the pressure tensor over 10s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">calc_fs</span><span class="p">(</span><span class="n">p_xyz_i</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;&gt; p_xyz_i = pyrf.movmean(p_xyz_i, int(10 * fs))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.mva">
<span id="pyrfu-pyrf-mva-module"></span><h2>pyrfu.pyrf.mva module<a class="headerlink" href="#module-pyrfu.pyrf.mva" title="Permalink to this headline">¶</a></h2>
<p>mva.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.mva.mva">
<code class="sig-prename descclassname">pyrfu.pyrf.mva.</code><code class="sig-name descname">mva</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag</span><span class="o">=</span><span class="default_value">'mvar'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/mva.html#mva"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.mva.mva" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum variance frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the quantity to find minimum variance frame.</p>
</dd>
<dt><strong>flag</strong><span class="classifier">{“mvar”, “&lt;bn&gt;=0”, “td”}</span></dt><dd><p>Constrain.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input quantity in LMN coordinates.</p>
</dd>
<dt><strong>l</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Eigenvalues l[0]&gt;l[1]&gt;l[2].</p>
</dd>
<dt><strong>lmn</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Eigenvectors LMN coordinates.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-pyrfu.pyrf.new_xyz" title="pyrfu.pyrf.new_xyz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.pyrf.new_xyz</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute MVA frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_lmn</span><span class="p">,</span> <span class="n">lamb</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">mva</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.new_xyz">
<span id="pyrfu-pyrf-new-xyz-module"></span><h2>pyrfu.pyrf.new_xyz module<a class="headerlink" href="#module-pyrfu.pyrf.new_xyz" title="Permalink to this headline">¶</a></h2>
<p>new_xyz.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.new_xyz.new_xyz">
<code class="sig-prename descclassname">pyrfu.pyrf.new_xyz.</code><code class="sig-name descname">new_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">trans_mat</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/new_xyz.html#new_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.new_xyz.new_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the input field to the new frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field in the original coordinate system.</p>
</dd>
<dt><strong>trans_mat</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Transformation matrix.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input in the new frame.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute MVA frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_lmn</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mva</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">mva</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Move electric field to the MVA frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_lmn</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">new_xyz</span><span class="p">(</span><span class="n">e_xyz</span><span class="p">,</span> <span class="n">mva</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.norm">
<span id="pyrfu-pyrf-norm-module"></span><h2>pyrfu.pyrf.norm module<a class="headerlink" href="#module-pyrfu.pyrf.norm" title="Permalink to this headline">¶</a></h2>
<p>norm.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.norm.norm">
<code class="sig-prename descclassname">pyrfu.pyrf.norm.</code><code class="sig-name descname">norm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/norm.html#norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.norm.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the magnitude of the input field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnitude of the input field.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_mag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.normalize">
<span id="pyrfu-pyrf-normalize-module"></span><h2>pyrfu.pyrf.normalize module<a class="headerlink" href="#module-pyrfu.pyrf.normalize" title="Permalink to this headline">¶</a></h2>
<p>normalize.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.normalize.normalize">
<code class="sig-prename descclassname">pyrfu.pyrf.normalize.</code><code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/normalize.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.normalize.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the input field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input field.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the normalized input field.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the normalized magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.pid_4sc">
<span id="pyrfu-pyrf-pid-4sc-module"></span><h2>pyrfu.pyrf.pid_4sc module<a class="headerlink" href="#module-pyrfu.pyrf.pid_4sc" title="Permalink to this headline">¶</a></h2>
<p>pid_4sc.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.pid_4sc.pid_4sc">
<code class="sig-prename descclassname">pyrfu.pyrf.pid_4sc.</code><code class="sig-name descname">pid_4sc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r_mms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_mms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">p_mms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_mms</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/pid_4sc.html#pid_4sc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.pid_4sc.pid_4sc" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Pi-D term using definition of <a class="reference internal" href="#rceb49c592c67-10" id="id19">[10]</a> as :</p>
<div class="math notranslate nohighlight">
\[\textrm{Pi}-\textrm{D} = - \mathbf{\Pi}_{ij}\mathbf{D}_{ij}\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{\Pi}_{ij}\)</span> the deviatoric part of the pressure tensor :</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{\Pi}_{ij} = \mathbf{P}_{ij} - p\delta_{ij}\\p = \frac{1}{3}\mathbf{P}_{ii}\end{aligned}\end{align} \]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{D}_{ij}\)</span> the deviatoric part of the strain tensor :</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{D}_{ij} = \frac{1}{2}\left ( \partial_i \mathbf{u}_j + \partial_j \mathbf{u}_i\right )
- \frac{1}{3}\theta\delta_{ij}\\\theta = \nabla . \mathbf{u}\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the position of the 4 spacecraft.</p>
</dd>
<dt><strong>v_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the bulk velocities of the 4 spacecraft.</p>
</dd>
<dt><strong>p_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the pressure tensor of the 4 spacecraft.</p>
</dd>
<dt><strong>b_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field of the 4 spacecraft.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pid</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the Pi-D.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rceb49c592c67-10"><span class="brackets"><a class="fn-backref" href="#id19">10</a></span></dt>
<dd><p>Yang, Y., Matthaeus, W. H., Parashar, T. N., Wu, P., Wan, M., Shi, Y., et al. (2017). Energy transfer
channels and turbulence cascade in Vlasov-Maxwell turbulence. Physical Review E, 95, 061201.
doi : <a class="reference external" href="https://doi.org/10.1103/PhysRevE.95.061201">https://doi.org/10.1103/PhysRevE.95.061201</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.plasma_beta">
<span id="pyrfu-pyrf-plasma-beta-module"></span><h2>pyrfu.pyrf.plasma_beta module<a class="headerlink" href="#module-pyrfu.pyrf.plasma_beta" title="Permalink to this headline">¶</a></h2>
<p>plasma_beta.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.plasma_beta.plasma_beta">
<code class="sig-prename descclassname">pyrfu.pyrf.plasma_beta.</code><code class="sig-name descname">plasma_beta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">p_xyz</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/plasma_beta.html#plasma_beta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.plasma_beta.plasma_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes plasma beta at magnetic field sampling</p>
<div class="math notranslate nohighlight">
\[\beta = \frac{P_{th}}{P_b}\]</div>
<p>where : <span class="math notranslate nohighlight">\(P_b = B^2 / 2 \mu_0\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field.</p>
</dd>
<dt><strong>p_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the pressure tensor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>beta</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the plasma beta at magnetic field sampling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.plasma_calc">
<span id="pyrfu-pyrf-plasma-calc-module"></span><h2>pyrfu.pyrf.plasma_calc module<a class="headerlink" href="#module-pyrfu.pyrf.plasma_calc" title="Permalink to this headline">¶</a></h2>
<p>plasma_calc.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.plasma_calc.plasma_calc">
<code class="sig-prename descclassname">pyrfu.pyrf.plasma_calc.</code><code class="sig-name descname">plasma_calc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t_i</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t_e</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_i</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_e</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/plasma_calc.html#plasma_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.plasma_calc.plasma_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes plasma parameters including characteristic length and time scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field [nT].</p>
</dd>
<dt><strong>t_i</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the ions scalar temperature [eV].</p>
</dd>
<dt><strong>t_e</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electrons scalar temperature [eV].</p>
</dd>
<dt><strong>n_i</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the ions number density [cm^{-3}].</p>
</dd>
<dt><strong>n_e</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electrons number density [cm^{-3}].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.Dataset</span></dt><dd><dl class="simple">
<dt>Dataset of the plasma parameters :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>time<span class="classifier">xarray.DataArray</span></dt><dd><p>Time.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Wpe<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron plasma frequency [rad.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Fpe<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron plasma frequency [Hz].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Wce<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron cyclotron frequency [rad.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Fce<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron cyclotron frequency [Hz].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Wpp<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the ion plasma frequency [rad.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Fpp<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the ion plasma frequency [Hz].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Fcp<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the ion cyclotron frequency [Hz].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Fuh<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the upper hybrid frequency [Hz].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Flh<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the lower hybrid frequency [Hz].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Va<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the Alfvèn velocity (ions) [m.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Vae<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the Alfvèn velocity (electrons) [m.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Vte<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron thermal velocity [m.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Vtp<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron thermal velocity [m.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Vts<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the sound speed [m.s^{-1}].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>gamma_e<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron Lorentz factor.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>gamma_p<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron Lorentz factor.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Le<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron inertial length [m].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Li<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron inertial length [m].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Ld<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the Debye length [m].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Nd<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the number of electrons in the Debye sphere.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Roe<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electron Larmor radius [m].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Rop<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the ion Larmor radius [m].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Ros<span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the length associated to the sound speed [m].</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, ion/electron temperature and number density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_xyz_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ti_gse_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_xyz_e</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Te_gse_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ni_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_e</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ne_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute scalar temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_xyzfac_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">t_xyz_i</span><span class="p">,</span> <span class="s2">&quot;fac&quot;</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_xyzfac_e</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">t_xyz_e</span><span class="p">,</span> <span class="s2">&quot;fac&quot;</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_i</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">t_xyzfac_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_e</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">t_xyzfac_e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute plasma parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plasma_params</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">plasma_calc</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">,</span> <span class="n">t_i</span><span class="p">,</span> <span class="n">t_e</span><span class="p">,</span> <span class="n">n_i</span><span class="p">,</span> <span class="n">n_e</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.poynting_flux">
<span id="pyrfu-pyrf-poynting-flux-module"></span><h2>pyrfu.pyrf.poynting_flux module<a class="headerlink" href="#module-pyrfu.pyrf.poynting_flux" title="Permalink to this headline">¶</a></h2>
<p>poynting_flux.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.poynting_flux.poynting_flux">
<code class="sig-prename descclassname">pyrfu.pyrf.poynting_flux.</code><code class="sig-name descname">poynting_flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b0</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/poynting_flux.html#poynting_flux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.poynting_flux.poynting_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates Poynting flux at electric field sampling as</p>
<div class="math notranslate nohighlight">
\[\mathbf{S} = \frac{\mathbf{E}\times\mathbf{B}}{\mu_0}\]</div>
<p>if <cite>b0</cite> is given project the Poynting flux along <cite>b0</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electric field.</p>
</dd>
<dt><strong>b_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field.</p>
</dd>
<dt><strong>b0</strong><span class="classifier">xarray.DataArray, optional</span></dt><dd><p>Time series of the direction to project the Pointing flux.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>s</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the Pointing flux.</p>
</dd>
<dt><strong>s_z</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the projection of the Pointing flux (only if b0).</p>
</dd>
<dt><strong>int_s</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the time integral of the Pointing flux (if b0 integral along b0).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.pres_anis">
<span id="pyrfu-pyrf-pres-anis-module"></span><h2>pyrfu.pyrf.pres_anis module<a class="headerlink" href="#module-pyrfu.pyrf.pres_anis" title="Permalink to this headline">¶</a></h2>
<p>pres_anis.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.pres_anis.pres_anis">
<code class="sig-prename descclassname">pyrfu.pyrf.pres_anis.</code><code class="sig-name descname">pres_anis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_xyz</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/pres_anis.html#pres_anis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.pres_anis.pres_anis" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute pressure anisotropy factor:</p>
<div class="math notranslate nohighlight">
\[\mu_0 \frac{P_\parallel - P_\perp}{|\mathbf{B}|^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>p_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the pressure tensor.</p>
</dd>
<dt><strong>b_xyz</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the background magnetic field.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>p_anis</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the pressure anisotropy.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="pyrfu.mms.html#module-pyrfu.mms.rotate_tensor" title="pyrfu.mms.rotate_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyrfu.mms.rotate_tensor</span></code></a></dt><dd><p>Rotates pressure or temperature tensor into another coordinate system.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, ion/electron temperature and number density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_xyz_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Pi_gse_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute pressure anistropy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_anis</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">pres_anis</span><span class="p">(</span><span class="n">p_xyz_i</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.psd">
<span id="pyrfu-pyrf-psd-module"></span><h2>pyrfu.pyrf.psd module<a class="headerlink" href="#module-pyrfu.pyrf.psd" title="Permalink to this headline">¶</a></h2>
<p>psd.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.psd.psd">
<code class="sig-prename descclassname">pyrfu.pyrf.psd.</code><code class="sig-name descname">psd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_fft</span><span class="o">=</span><span class="default_value">256</span></em>, <em class="sig-param"><span class="n">n_overlap</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hamming'</span></em>, <em class="sig-param"><span class="n">d_flag</span><span class="o">=</span><span class="default_value">'constant'</span></em>, <em class="sig-param"><span class="n">scaling</span><span class="o">=</span><span class="default_value">'density'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/psd.html#psd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.psd.psd" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate power spectral density using Welch’s method.</p>
<p>Welch’s method <a class="reference internal" href="#r693fdd856310-11" id="id21">[11]</a> computes an estimate of the power spectral density by dividing the data into overlapping
segments, computing a modified periodogram for each segment and averaging the periodograms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of measurement values.</p>
</dd>
<dt><strong>n_fft</strong><span class="classifier">int, optional</span></dt><dd><p>Length of the FFT used, if a zero padded FFT is desired. Default to 256.</p>
</dd>
<dt><strong>n_overlap</strong><span class="classifier">int, optional</span></dt><dd><p>Number of points to overlap between segments. Default to 128.</p>
</dd>
<dt><strong>window</strong><span class="classifier">str, optional</span></dt><dd><p>Desired window to use. It is passed to <cite>get_window</cite> to generate the window values, which are DFT-even by
default. See “get_window” or a list of windows and required parameters. Default Hanning</p>
</dd>
<dt><strong>d_flag</strong><span class="classifier">str, optional</span></dt><dd><p>Specifies how to detrend each segment. It is passed as the “type” argument to the “detrend” function. Default
to “constant”.</p>
</dd>
<dt><strong>scaling</strong><span class="classifier">str, optional</span></dt><dd><p>Selects between computing the power spectral density (‘density’) where <cite>Pxx</cite> has units of V**2/Hz and computing
the power spectrum (“spectrum”) where “Pxx” has units of V**2, if <cite>x</cite> is measured in V and “fs” is measured in
Hz. Default to ‘density’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Power spectral density or power spectrum of inp.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r693fdd856310-11"><span class="brackets"><a class="fn-backref" href="#id21">11</a></span></dt>
<dd><p>P. Welch, “The use of the fast Fourier transform for the estimation of power spectra: A method based on time
averaging over short, modified periodograms”, IEEE Trans. Audio Electroacoust. vol. 15, pp. 70-73, 1967.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.pvi">
<span id="pyrfu-pyrf-pvi-module"></span><h2>pyrfu.pyrf.pvi module<a class="headerlink" href="#module-pyrfu.pyrf.pvi" title="Permalink to this headline">¶</a></h2>
<p>pvi.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.pvi.pvi">
<code class="sig-prename descclassname">pyrfu.pyrf.pvi.</code><code class="sig-name descname">pvi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/pvi.html#pvi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.pvi.pvi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the PVI of a time series.</p>
<div class="math notranslate nohighlight">
\[y = \frac{|x_i - x_{i+s}|^2}{&lt;|x_i - x_{i+s}|^2&gt;}\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is the scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input time series.</p>
</dd>
<dt><strong>scale</strong><span class="classifier">int</span></dt><dd><p>Scale at which to compute the PVI.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>values</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>An xarray containing the pvi of the original time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.pvi_4sc">
<span id="pyrfu-pyrf-pvi-4sc-module"></span><h2>pyrfu.pyrf.pvi_4sc module<a class="headerlink" href="#module-pyrfu.pyrf.pvi_4sc" title="Permalink to this headline">¶</a></h2>
<p>pvi_4sc.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.pvi_4sc.pvi_4sc">
<code class="sig-prename descclassname">pyrfu.pyrf.pvi_4sc.</code><code class="sig-name descname">pvi_4sc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b_mms</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/pvi_4sc.html#pvi_4sc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.pvi_4sc.pvi_4sc" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Partial Variance of Increments (PVI) using the definition in <a class="reference internal" href="#r20c11db93bc8-12" id="id23">[12]</a> as</p>
<div class="math notranslate nohighlight">
\[PVI_{ij}(t) = \sqrt{\frac{|\Delta \mathbf{B}_{ij}(t)|^2}{\langle|\Delta \mathbf{B}_{ij}|^2\rangle}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta \mathbf{B}_{ij}(t) = \mathbf{B}_i(t) - \mathbf{B}_i(t)\)</span> is the magnetic field increments,
the average <span class="math notranslate nohighlight">\(\langle . \rangle\)</span> is taken over the whole interval, and <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> = 1,2,3,4
is the MMS spacecraft number.</p>
<p>In addition, computes, the rotation of the magnetic field between two spacecraft, i.e., magnetic field shear angle,
as :</p>
<div class="math notranslate nohighlight">
\[\alpha_{ij}(t) = cos^{-1} \frac{\mathbf{B}_i(t).\mathbf{B}_j(t)}{|\mathbf{B}_i(t)| |\mathbf{B}_j(t)|}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>List of the time series of the background magnetic field for the 4 spacecraft.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pvi_ij</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the Partial Variance of Increments for the 6 pairs of spacecraft.</p>
</dd>
<dt><strong>alpha_ij</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field shear angle for the 6 pairs of spacecraft.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r20c11db93bc8-12"><span class="brackets"><a class="fn-backref" href="#id23">12</a></span></dt>
<dd><p>Chasapis, A., Retinó, A., Sahraoui, F., Vaivads, A., Khotyaintsev, Yu. V., Sundkvist, D., et al. (2015)
Thin current sheets and associated electron heating in turbulent space plasma. Astrophys. J. Lett. 804:L1.
doi: <a class="reference external" href="https://doi.org/10.1088/2041-8205/804/1/L1">https://doi.org/10.1088/2041-8205/804/1/L1</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.remove_repeated_points">
<span id="pyrfu-pyrf-remove-repeated-points-module"></span><h2>pyrfu.pyrf.remove_repeated_points module<a class="headerlink" href="#module-pyrfu.pyrf.remove_repeated_points" title="Permalink to this headline">¶</a></h2>
<p>remove_repeated_points.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.remove_repeated_points.remove_repeated_points">
<code class="sig-prename descclassname">pyrfu.pyrf.remove_repeated_points.</code><code class="sig-name descname">remove_repeated_points</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/remove_repeated_points.html#remove_repeated_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.remove_repeated_points.remove_repeated_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove repeated elements in DataArray or structure data. Important when using defatt products.
Must have a time variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray or dict</span></dt><dd><p>Time series of the input variable.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>out: xarray.DataArray or dict</dt><dd><p>Time series of the cleaned input variable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.resample">
<span id="pyrfu-pyrf-resample-module"></span><h2>pyrfu.pyrf.resample module<a class="headerlink" href="#module-pyrfu.pyrf.resample" title="Permalink to this headline">¶</a></h2>
<p>resample.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.resample.resample">
<code class="sig-prename descclassname">pyrfu.pyrf.resample.</code><code class="sig-name descname">resample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/resample.html#resample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.resample.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample inp to the time line of ref. If sampling of X is more than two times higher than Y, we average X, otherwise
we interpolate X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series to resample.</p>
</dd>
<dt><strong>ref</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Reference time line.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Hash table of keyword arguments with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>method<span class="classifier">str</span></dt><dd><p>Method of interpolation “spline”, “linear” etc. (default “linear”) if method is given then interpolate
independent of sampling.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>fs<span class="classifier">float</span></dt><dd><p>Sampling frequency of the Y signal, 1/window.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>window<span class="classifier">int or float or np.ndarray</span></dt><dd><p>Length of the averaging window, 1/fsample.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>fs<span class="classifier">str</span></dt><dd><p>Sampling frequency of the Y signal, 1/window.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mean<span class="classifier">bool</span></dt><dd><p>Use mean when averaging.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>median<span class="classifier">bool</span></dt><dd><p>Use median instead of mean when averaging.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>max<span class="classifier">bool</span></dt><dd><p>Use max instead of mean when averaging.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Resampled input to the reference time line using the selected method.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Resample magnetic field to electric field sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">b_xyz</span><span class="p">,</span> <span class="n">e_xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.solid_angle">
<span id="pyrfu-pyrf-solid-angle-module"></span><h2>pyrfu.pyrf.solid_angle module<a class="headerlink" href="#module-pyrfu.pyrf.solid_angle" title="Permalink to this headline">¶</a></h2>
<p>solid_angle.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.solid_angle.solid_angle">
<code class="sig-prename descclassname">pyrfu.pyrf.solid_angle.</code><code class="sig-name descname">solid_angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/solid_angle.html#solid_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.solid_angle.solid_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the solid angle of three vectors making up a triangle in a unit sphere with the sign taken into
account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>First vector.</p>
</dd>
<dt><strong>y</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Second vector.</p>
</dd>
<dt><strong>z</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Third vector.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>angle</strong><span class="classifier">float</span></dt><dd><p>Solid angle.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.st_diff">
<span id="pyrfu-pyrf-st-diff-module"></span><h2>pyrfu.pyrf.st_diff module<a class="headerlink" href="#module-pyrfu.pyrf.st_diff" title="Permalink to this headline">¶</a></h2>
<p>st_diff.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.st_diff.st_diff">
<code class="sig-prename descclassname">pyrfu.pyrf.st_diff.</code><code class="sig-name descname">st_diff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r_mms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_mms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lmn</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/st_diff.html#st_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.st_diff.st_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes velocity of the structure using spatio-temporal derivative method <a class="reference internal" href="#r741e88caedc4-13" id="id25">[13]</a> <a class="reference internal" href="#r741e88caedc4-14" id="id26">[14]</a> as</p>
<div class="math notranslate nohighlight">
\[\mathbf{V}_{str}^{\mathbf{LMN}} = -\textrm{d}_t \mathbf{B}^{\mathbf{LMN}} \left [\nabla^{\mathbf{LMN}}
\mathbf{B}^{\mathbf{LMN}}\right]^T \left [\mathbf{S}^{\mathbf{LMN}}\right ]^{-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{B}^{\mathbf{LMN}}\)</span>, <span class="math notranslate nohighlight">\(\nabla^{\mathbf{LMN}}\mathbf{B}^{\mathbf{LMN}}\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{S}^{\mathbf{LMN}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{V}_{str}^{\mathbf{LMN}}\)</span> are namely the magnetic field,
its gradient, its rotation rate tensor and the velocity of the structure in the LMN coordinates system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Spacecraft positions.</p>
</dd>
<dt><strong>b_mms</strong><span class="classifier">list of xarray.DataArray</span></dt><dd><p>Background magnetic field.</p>
</dd>
<dt><strong>lmn</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Structure coordinates system.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>v_str</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Velocity of the structure in its coordinates system.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r741e88caedc4-13"><span class="brackets"><a class="fn-backref" href="#id25">13</a></span></dt>
<dd><p>Shi, Q. Q., Shen, C., Pu, Z. Y., Dunlop, M. W., Zong, Q. G., Zhang, H., et al. (2005), Dimensional analysis
of observed structures using multipoint magnetic field measurements: Application to Cluster. Geophysical
Research Letters, 32, L12105. doi : <a class="reference external" href="https://doi.org/10.1029/2005GL022454">https://doi.org/10.1029/2005GL022454</a>.</p>
</dd>
<dt class="label" id="r741e88caedc4-14"><span class="brackets"><a class="fn-backref" href="#id26">14</a></span></dt>
<dd><p>Shi, Q. Q., Shen, C., Dunlop, M. W., Pu, Z. Y., Zong, Q. G., Liu, Z. X., et al. (2006), Motion of observed
structures calculated from multi‐point magnetic field measurements: Application to Cluster. Geophysical
Research Letters, 33, L08109. doi : <a class="reference external" href="https://doi.org/10.1029/2005GL025073">https://doi.org/10.1029/2005GL025073</a>.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.start">
<span id="pyrfu-pyrf-start-module"></span><h2>pyrfu.pyrf.start module<a class="headerlink" href="#module-pyrfu.pyrf.start" title="Permalink to this headline">¶</a></h2>
<p>start.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.start.start">
<code class="sig-prename descclassname">pyrfu.pyrf.start.</code><code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/start.html#start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.start.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the first time of the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">float or str</span></dt><dd><p>Value of the first time in the desired format.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.struct_func">
<span id="pyrfu-pyrf-struct-func-module"></span><h2>pyrfu.pyrf.struct_func module<a class="headerlink" href="#module-pyrfu.pyrf.struct_func" title="Permalink to this headline">¶</a></h2>
<p>struct_func.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.struct_func.struct_func">
<code class="sig-prename descclassname">pyrfu.pyrf.struct_func.</code><code class="sig-name descname">struct_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/struct_func.html#struct_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.struct_func.struct_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the structure function of a time series</p>
<div class="math notranslate nohighlight">
\[y= \frac{1}{N-s}\sum_{i=1}^{N-s}(x_i - x_{i+s})^o\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is the scale, and <span class="math notranslate nohighlight">\(o\)</span> is the order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input time series.</p>
</dd>
<dt><strong>scale</strong><span class="classifier">list or numpy.ndarray</span></dt><dd><p>A list or an array containing the scales to calculate.</p>
</dd>
<dt><strong>order</strong><span class="classifier">int</span></dt><dd><p>Order of the exponential of the structure function.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>values</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>An xarray containing the structure functions, one per product in the original time series. The index coordinate
contains the scale value, and the attribute ‘order’ keeps a record on the order used for its calculation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.t_eval">
<span id="pyrfu-pyrf-t-eval-module"></span><h2>pyrfu.pyrf.t_eval module<a class="headerlink" href="#module-pyrfu.pyrf.t_eval" title="Permalink to this headline">¶</a></h2>
<p>t_eval.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.t_eval.t_eval">
<code class="sig-prename descclassname">pyrfu.pyrf.t_eval.</code><code class="sig-name descname">t_eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/t_eval.html#t_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.t_eval.t_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the input time series at the target time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series if the input to evaluate.</p>
</dd>
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Times at which the input will be evaluated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">DataArray</span></dt><dd><p>Time series of the input at times t.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.time_clip">
<span id="pyrfu-pyrf-time-clip-module"></span><h2>pyrfu.pyrf.time_clip module<a class="headerlink" href="#module-pyrfu.pyrf.time_clip" title="Permalink to this headline">¶</a></h2>
<p>time_clip.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.time_clip.time_clip">
<code class="sig-prename descclassname">pyrfu.pyrf.time_clip.</code><code class="sig-name descname">time_clip</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tint</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/time_clip.html#time_clip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.time_clip.time_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Time clip the input (if time interval is TSeries clip between start and stop).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the quantity to clip.</p>
</dd>
<dt><strong>tint</strong><span class="classifier">xarray.DataArray or numpy.ndarray or list</span></dt><dd><p>Time interval can be a time series, a array of datetime64 or a list.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the time clipped input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.trace">
<span id="pyrfu-pyrf-trace-module"></span><h2>pyrfu.pyrf.trace module<a class="headerlink" href="#module-pyrfu.pyrf.trace" title="Permalink to this headline">¶</a></h2>
<p>trace.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.trace.trace">
<code class="sig-prename descclassname">pyrfu.pyrf.trace.</code><code class="sig-name descname">trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/trace.html#trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.trace.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes trace of the time series of 2nd order tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the input 2nd order tensor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the trace of the input tensor.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">mms</span><span class="p">,</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mms_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and ion temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_xyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_xyz_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ti_gse_fpi_fast_l2&quot;</span><span class="p">,</span> <span class="n">tint</span><span class="p">,</span> <span class="n">mms_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rotate to ion temperature tensor to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_xyzfac_i</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">t_xyz_i</span><span class="p">,</span> <span class="s2">&quot;fac&quot;</span><span class="p">,</span> <span class="n">b_xyz</span><span class="p">,</span> <span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute scalar temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_i</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">t_xyzfac_i</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ts_append">
<span id="pyrfu-pyrf-ts-append-module"></span><h2>pyrfu.pyrf.ts_append module<a class="headerlink" href="#module-pyrfu.pyrf.ts_append" title="Permalink to this headline">¶</a></h2>
<p>ts_append.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ts_append.ts_append">
<code class="sig-prename descclassname">pyrfu.pyrf.ts_append.</code><code class="sig-name descname">ts_append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp2</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ts_append.html#ts_append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ts_append.ts_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate two time series along the time axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp1</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the first input (early times).</p>
</dd>
<dt><strong>inp2</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the second input (late times).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Concatenated time series.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The time series must be in the correct time order.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ts_scalar">
<span id="pyrfu-pyrf-ts-scalar-module"></span><h2>pyrfu.pyrf.ts_scalar module<a class="headerlink" href="#module-pyrfu.pyrf.ts_scalar" title="Permalink to this headline">¶</a></h2>
<p>ts_scalar.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ts_scalar.ts_scalar">
<code class="sig-prename descclassname">pyrfu.pyrf.ts_scalar.</code><code class="sig-name descname">ts_scalar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attrs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ts_scalar.html#ts_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ts_scalar.ts_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a time series containing a 0th order tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Array of times.</p>
</dd>
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Data corresponding to the time list.</p>
</dd>
<dt><strong>attrs</strong><span class="classifier">dict</span></dt><dd><p>Attributes of the data list.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>0th order tensor time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ts_skymap">
<span id="pyrfu-pyrf-ts-skymap-module"></span><h2>pyrfu.pyrf.ts_skymap module<a class="headerlink" href="#module-pyrfu.pyrf.ts_skymap" title="Permalink to this headline">¶</a></h2>
<p>ts_skymap.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ts_skymap.ts_skymap">
<code class="sig-prename descclassname">pyrfu.pyrf.ts_skymap.</code><code class="sig-name descname">ts_skymap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">energy</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">phi</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">theta</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ts_skymap.html#ts_skymap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ts_skymap.ts_skymap" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a skymap of the distribution function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>List of times.</p>
</dd>
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Values of the distribution function.</p>
</dd>
<dt><strong>energy</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Energy levels.</p>
</dd>
<dt><strong>phi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Azimuthal angles.</p>
</dd>
<dt><strong>theta</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Elevation angles.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Hash table of keyword arguments with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>energy0<span class="classifier">numpy.ndarray</span></dt><dd><p>Energy table 0 (odd time indices).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>energy1<span class="classifier">numpy.ndarray</span></dt><dd><p>Energy table 1 (even time indices).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>esteptable<span class="classifier">numpy.ndarray</span></dt><dd><p>Time series of the stepping table between energies (burst).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Skymap of the distribution function.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ts_tensor_xyz">
<span id="pyrfu-pyrf-ts-tensor-xyz-module"></span><h2>pyrfu.pyrf.ts_tensor_xyz module<a class="headerlink" href="#module-pyrfu.pyrf.ts_tensor_xyz" title="Permalink to this headline">¶</a></h2>
<p>ts_tensor_xyz.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ts_tensor_xyz.ts_tensor_xyz">
<code class="sig-prename descclassname">pyrfu.pyrf.ts_tensor_xyz.</code><code class="sig-name descname">ts_tensor_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attrs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ts_tensor_xyz.html#ts_tensor_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ts_tensor_xyz.ts_tensor_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a time series containing a 2nd order tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Array of times.</p>
</dd>
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Data corresponding to the time list.</p>
</dd>
<dt><strong>attrs</strong><span class="classifier">dict</span></dt><dd><p>Attributes of the data list.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>2nd order tensor time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ts_time">
<span id="pyrfu-pyrf-ts-time-module"></span><h2>pyrfu.pyrf.ts_time module<a class="headerlink" href="#module-pyrfu.pyrf.ts_time" title="Permalink to this headline">¶</a></h2>
<p>ts_time.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ts_time.ts_time">
<code class="sig-prename descclassname">pyrfu.pyrf.ts_time.</code><code class="sig-name descname">ts_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">'unix'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ts_time.html#ts_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ts_time.ts_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates time line in DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Input time line.</p>
</dd>
<dt><strong>fmt</strong><span class="classifier">str</span></dt><dd><p>Format of the input time line.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the time line.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.ts_vec_xyz">
<span id="pyrfu-pyrf-ts-vec-xyz-module"></span><h2>pyrfu.pyrf.ts_vec_xyz module<a class="headerlink" href="#module-pyrfu.pyrf.ts_vec_xyz" title="Permalink to this headline">¶</a></h2>
<p>ts_vec_xyz.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.ts_vec_xyz.ts_vec_xyz">
<code class="sig-prename descclassname">pyrfu.pyrf.ts_vec_xyz.</code><code class="sig-name descname">ts_vec_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attrs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/ts_vec_xyz.html#ts_vec_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.ts_vec_xyz.ts_vec_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a time series containing a 1st order tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Array of times.</p>
</dd>
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Data corresponding to the time list.</p>
</dd>
<dt><strong>attrs</strong><span class="classifier">dict</span></dt><dd><p>Attributes of the data list.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xaray.DataArray</span></dt><dd><p>1st order tensor time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.vht">
<span id="pyrfu-pyrf-vht-module"></span><h2>pyrfu.pyrf.vht module<a class="headerlink" href="#module-pyrfu.pyrf.vht" title="Permalink to this headline">¶</a></h2>
<p>vht.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.vht.vht">
<code class="sig-prename descclassname">pyrfu.pyrf.vht.</code><code class="sig-name descname">vht</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/vht.html#vht"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.vht.vht" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate velocity of the De Hoffman-Teller frame from the velocity estimate the electric field eht=-vht x b</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electric field.</p>
</dd>
<dt><strong>b</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field.</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>If 2 assumed no Ez.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vht</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>De Hoffman Teller frame velocity [km/s].</p>
</dd>
<dt><strong>vht</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the electric field in the De Hoffman frame.</p>
</dd>
<dt><strong>dv_ht</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Error of De Hoffman Teller frame.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.wave_fft">
<span id="pyrfu-pyrf-wave-fft-module"></span><h2>pyrfu.pyrf.wave_fft module<a class="headerlink" href="#module-pyrfu.pyrf.wave_fft" title="Permalink to this headline">¶</a></h2>
<p>wave_fft.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.wave_fft.wave_fft">
<code class="sig-prename descclassname">pyrfu.pyrf.wave_fft.</code><code class="sig-name descname">wave_fft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hamming'</span></em>, <em class="sig-param"><span class="n">frame_overlap</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">frame_length</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">fs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/wave_fft.html#wave_fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.wave_fft.wave_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Short-Time Fourier Transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the one dimension data.</p>
</dd>
<dt><strong>window</strong><span class="classifier">str</span></dt><dd><p>Window function such as rectwin, hamming (default).</p>
</dd>
<dt><strong>frame_overlap</strong><span class="classifier">float</span></dt><dd><p>Length of each frame overlaps in second.</p>
</dd>
<dt><strong>frame_length</strong><span class="classifier">float</span></dt><dd><p>Length of each frame in second.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float</span></dt><dd><p>Sampling frequency.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>s</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Spectrogram of x.</p>
</dd>
<dt><strong>t</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Value corresponds to the center of each frame (x-axis) in sec.</p>
</dd>
<dt><strong>f</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vector of frequencies (y-axis) in Hz.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.wavelet">
<span id="pyrfu-pyrf-wavelet-module"></span><h2>pyrfu.pyrf.wavelet module<a class="headerlink" href="#module-pyrfu.pyrf.wavelet" title="Permalink to this headline">¶</a></h2>
<p>wavelet.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.wavelet.wavelet">
<code class="sig-prename descclassname">pyrfu.pyrf.wavelet.</code><code class="sig-name descname">wavelet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/wavelet.html#wavelet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.wavelet.wavelet" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes wavelet spectrogram based on fast FFT algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Input quantity.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Hash table of keyword arguments with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>fs<span class="classifier">int or float</span></dt><dd><p>Sampling frequency of the input time series.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>f<span class="classifier">list or numpy.ndarray</span></dt><dd><p>Vector [f_min f_max], calculate spectra between frequencies f_min and f_max.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nf<span class="classifier">int or float</span></dt><dd><p>Number of frequency bins.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>wavelet_width<span class="classifier">int or float</span></dt><dd><p>Width of the Morlet wavelet. Default 5.36.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>linear<span class="classifier">float</span></dt><dd><p>Linear spacing between frequencies of df.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>return_power<span class="classifier">bool</span></dt><dd><p>Set to True to return the power, False for complex wavelet transform. Default True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cut_edge<span class="classifier">bool</span></dt><dd><p>Set to True to set points affected by edge effects to NaN, False to keep edge affect points.
Default True</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">xarray.DataArray or xarray.Dataset</span></dt><dd><p>Wavelet transform of the input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf.wavepolarize_means">
<span id="pyrfu-pyrf-wavepolarize-means-module"></span><h2>pyrfu.pyrf.wavepolarize_means module<a class="headerlink" href="#module-pyrfu.pyrf.wavepolarize_means" title="Permalink to this headline">¶</a></h2>
<p>wavepolarize_means.py</p>
<p>&#64;author : Louis RICHARD</p>
<dl class="py function">
<dt id="pyrfu.pyrf.wavepolarize_means.wavepolarize_means">
<code class="sig-prename descclassname">pyrfu.pyrf.wavepolarize_means.</code><code class="sig-name descname">wavepolarize_means</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b_bgd</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrfu/pyrf/wavepolarize_means.html#wavepolarize_means"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrfu.pyrf.wavepolarize_means.wavepolarize_means" title="Permalink to this definition">¶</a></dt>
<dd><p>Analysis the polarization of magnetic wave using “means” method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b_wave</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field from Search Coil Magnetometer (SCM).</p>
</dd>
<dt><strong>b_bgd</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Time series of the magnetic field from Flux Gate Magnetometer (FGM).</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Hash table of keyword arguments with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>min_psd<span class="classifier">float</span></dt><dd><p>Threshold for the analysis (e.g 1.0e-7). Below this value, the SVD analysis is meaningless if min_psd is
not given, SVD analysis will be done for all waves. (default 1e-25).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nop_fft<span class="classifier">int</span></dt><dd><p>Number of points in FFT. (default 256).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>b_psd</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Power spectrum density of magnetic filed wave.</p>
</dd>
<dt><strong>wave_angle</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>(form 0 to 90)</p>
</dd>
<dt><strong>deg_pol</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Spectrogram of the degree of polarization (form 0 to 1).</p>
</dd>
<dt><strong>elliptict</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Spectrogram of the ellipticity (form -1 to 1)</p>
</dd>
<dt><strong>helict</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Spectrogram of the helicity (form -1 to 1)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><code class="docutils literal notranslate"><span class="pre">b_wave</span></code> and <code class="docutils literal notranslate"><span class="pre">b_bgd</span></code> should be from the same satellite and in the same coordinates</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If one component is an order of magnitude or more  greater than the other two then the polarization
results saturate and erroneously indicate high degrees of polarization at all times and frequencies. Time
series should be eyeballed before running the program.
For time series containing very rapid changes or spikes the usual problems with Fourier analysis arise.
Care should be taken in evaluating degree of polarization results.
For meaningful results there should be significant wave power at the frequency where the polarization
approaches 100%. Remember comparing two straight lines yields 100% polarization.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyrfu</span> <span class="kn">import</span> <span class="n">pyrf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarization</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">wavepolarize_means</span><span class="p">(</span><span class="n">b_wave</span><span class="p">,</span> <span class="n">b_bgd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarization</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">wavepolarize_means</span><span class="p">(</span><span class="n">b_wave</span><span class="p">,</span> <span class="n">b_bgd</span><span class="p">,</span> <span class="mf">1.0e-7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarization</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">wavepolarize_means</span><span class="p">(</span><span class="n">b_wave</span><span class="p">,</span> <span class="n">b_bgd</span><span class="p">,</span> <span class="mf">1.0e-7</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrfu.pyrf">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrfu.pyrf" title="Permalink to this headline">¶</a></h2>
<p>__init__.py</p>
<p>&#64;author : Louis RICHARD</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/IRF_logo_blue_on_white.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pyrfu.pyrf package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.agyro_coeff">pyrfu.pyrf.agyro_coeff module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.avg_4sc">pyrfu.pyrf.avg_4sc module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.c_4_grad">pyrfu.pyrf.c_4_grad module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.c_4_j">pyrfu.pyrf.c_4_j module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.c_4_k">pyrfu.pyrf.c_4_k module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.c_4_v">pyrfu.pyrf.c_4_v module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.calc_disprel_tm">pyrfu.pyrf.calc_disprel_tm module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.calc_dt">pyrfu.pyrf.calc_dt module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.calc_fs">pyrfu.pyrf.calc_fs module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.cart2sph">pyrfu.pyrf.cart2sph module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.convert_fac">pyrfu.pyrf.convert_fac module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.corr_deriv">pyrfu.pyrf.corr_deriv module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.cross">pyrfu.pyrf.cross module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.date_str">pyrfu.pyrf.date_str module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.dec_par_perp">pyrfu.pyrf.dec_par_perp module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.disp_surf_calc">pyrfu.pyrf.disp_surf_calc module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.dist_append">pyrfu.pyrf.dist_append module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.dot">pyrfu.pyrf.dot module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.dynamic_press">pyrfu.pyrf.dynamic_press module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.e_vxb">pyrfu.pyrf.e_vxb module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.eb_nrf">pyrfu.pyrf.eb_nrf module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ebsp">pyrfu.pyrf.ebsp module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.edb">pyrfu.pyrf.edb module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.end">pyrfu.pyrf.end module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.extend_tint">pyrfu.pyrf.extend_tint module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.filt">pyrfu.pyrf.filt module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.find_closest">pyrfu.pyrf.find_closest module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.generic_minimum_residue_analysis">pyrfu.pyrf.generic_minimum_residue_analysis module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.gradient">pyrfu.pyrf.gradient module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.histogram">pyrfu.pyrf.histogram module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.histogram2d">pyrfu.pyrf.histogram2d module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.increments">pyrfu.pyrf.increments module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.int_sph_dist">pyrfu.pyrf.int_sph_dist module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.integrate">pyrfu.pyrf.integrate module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.iso2unix">pyrfu.pyrf.iso2unix module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.lowpass">pyrfu.pyrf.lowpass module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.mean">pyrfu.pyrf.mean module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.mean_bins">pyrfu.pyrf.mean_bins module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.medfilt">pyrfu.pyrf.medfilt module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.median_bins">pyrfu.pyrf.median_bins module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.movmean">pyrfu.pyrf.movmean module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.mva">pyrfu.pyrf.mva module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.new_xyz">pyrfu.pyrf.new_xyz module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.norm">pyrfu.pyrf.norm module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.normalize">pyrfu.pyrf.normalize module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.pid_4sc">pyrfu.pyrf.pid_4sc module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.plasma_beta">pyrfu.pyrf.plasma_beta module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.plasma_calc">pyrfu.pyrf.plasma_calc module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.poynting_flux">pyrfu.pyrf.poynting_flux module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.pres_anis">pyrfu.pyrf.pres_anis module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.psd">pyrfu.pyrf.psd module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.pvi">pyrfu.pyrf.pvi module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.pvi_4sc">pyrfu.pyrf.pvi_4sc module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.remove_repeated_points">pyrfu.pyrf.remove_repeated_points module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.resample">pyrfu.pyrf.resample module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.solid_angle">pyrfu.pyrf.solid_angle module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.st_diff">pyrfu.pyrf.st_diff module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.start">pyrfu.pyrf.start module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.struct_func">pyrfu.pyrf.struct_func module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.t_eval">pyrfu.pyrf.t_eval module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.time_clip">pyrfu.pyrf.time_clip module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.trace">pyrfu.pyrf.trace module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ts_append">pyrfu.pyrf.ts_append module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ts_scalar">pyrfu.pyrf.ts_scalar module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ts_skymap">pyrfu.pyrf.ts_skymap module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ts_tensor_xyz">pyrfu.pyrf.ts_tensor_xyz module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ts_time">pyrfu.pyrf.ts_time module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.ts_vec_xyz">pyrfu.pyrf.ts_vec_xyz module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.vht">pyrfu.pyrf.vht module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.wave_fft">pyrfu.pyrf.wave_fft module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.wavelet">pyrfu.pyrf.wavelet module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf.wavepolarize_means">pyrfu.pyrf.wavepolarize_means module</a></li>
<li><a class="reference internal" href="#module-pyrfu.pyrf">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pyrfu.plot.html"
                        title="previous chapter">pyrfu.plot package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pyrfu.solo.html"
                        title="next chapter">pyrfu.solo package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pyrfu.pyrf.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyrfu.solo.html" title="pyrfu.solo package"
             >next</a> |</li>
        <li class="right" >
          <a href="pyrfu.plot.html" title="pyrfu.plot package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyrfu 1.6.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="pyrfu.html" >pyrfu package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyrfu.pyrf package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Louis RICHARD.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>