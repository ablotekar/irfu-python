
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to pyrfu’s documentation! &#8212; pyrfu  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="install.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">pyrfu  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Welcome to pyrfu’s documentation!</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-pyrfu-s-documentation">
<h1>Welcome to pyrfu’s documentation!<a class="headerlink" href="#welcome-to-pyrfu-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>
</div>
<div class="section" id="module-pyrf">
<span id="pyrf"></span><h2><a class="reference internal" href="#module-pyrf" title="pyrf: Generic functions (Unix, Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyrf</span></code></a><a class="headerlink" href="#module-pyrf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pyrf-agyro-coeff">
<h3><a class="reference internal" href="#pyrf.agyro_coeff" title="pyrf.agyro_coeff"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyrf.agyro_coeff()</span></code></a><a class="headerlink" href="#pyrf-agyro-coeff" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.agyro_coeff">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">agyro_coeff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.agyro_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes agyrotropy coefficient <a class="footnote-reference brackets" href="#id2" id="id1">1</a></p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>P<span class="classifier">DataArray</span></dt><dd><p>Time series of the pressure tensor</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>Q<span class="classifier">DataArray</span></dt><dd><p>Time series of the agyrotropy coefficient of the specie</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electron pressure tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pexyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Pe_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rotate electron pressure tensor to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pexyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">Pexyz</span><span class="p">,</span><span class="s2">&quot;fac&quot;</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute agyrotropy coefficient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Qe</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">agyro_coeff</span><span class="p">(</span><span class="n">Pexyzfac</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><ol class="upperalpha simple" start="13">
<li><p>Swisdak “Quantifying gyrotropy in magnetic reconnection” vol. 43, pp. 43-49, 2016</p></li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="avg-4sc">
<h3><a class="reference internal" href="#pyrf.avg_4sc" title="pyrf.avg_4sc"><code class="xref py py-func docutils literal notranslate"><span class="pre">avg_4sc()</span></code></a><a class="headerlink" href="#avg-4sc" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.avg_4sc">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">avg_4sc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">B</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.avg_4sc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the input quantity at the center of mass of the MMS tetrahedron</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>B</em><span class="classifier">list of DataArray</span></dt><dd><p>List of the time series of the quantity for each spacecraft</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>Bavg</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input quantity a the enter of mass of the MMS tetrahedron</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the magnetic field at the center of mass of the MMS tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyzavg</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">avg_4sc</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="c-4-grad">
<h3><a class="reference internal" href="#pyrf.c_4_grad" title="pyrf.c_4_grad"><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_grad()</span></code></a><a class="headerlink" href="#c-4-grad" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.c_4_grad">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">c_4_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">B</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'grad'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.c_4_grad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculate gradient of physical field using 4 spacecraft technique.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>R</em><span class="classifier">list of DataArray</span></dt><dd><p>Time series of the positions of the spacecraft</p>
</dd>
<dt><em>B</em><span class="classifier">list of DataArray</span></dt><dd><p>Time series of the magnetic field at the corresponding positions</p>
</dd>
<dt><em>method</em><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Method flag :</dt><dd><p>“grad” -&gt; compute gradient (default)
“div” -&gt; compute divergence
“curl” -&gt; compute curl
“bdivb” -&gt; compute b.div(b)
“curv” -&gt; compute curvature</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the derivative of the input field corresponding to the method</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute gradient of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gradB</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_grad</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;grad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Reference :</dt><dd><p>ISSI book  Eq. 14.16, 14.17 p. 353</p>
</dd>
<dt>See also :</dt><dd><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_k()</span></code></p>
</dd>
</dl>
</div>
<div class="section" id="c-4-j">
<h3><a class="reference internal" href="#pyrf.c_4_j" title="pyrf.c_4_j"><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_j()</span></code></a><a class="headerlink" href="#c-4-j" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.c_4_j">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">c_4_j</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">B</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.c_4_j" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculate current from using 4 spacecraft technique in addition one can obtain average magnetic field and <span class="math notranslate nohighlight">\(\mathbf{J}\times\mathbf{B}\)</span>
values. Estimate also divergence B as the error estimate</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>R</em><span class="classifier">list of DataArrays</span></dt><dd><p>Time series of the spacecraft position [km]</p>
</dd>
<dt><em>B</em><span class="classifier">list of DataArray</span></dt><dd><p>Time series of the magnetic field [nT]</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>j</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the current density <span class="math notranslate nohighlight">\(\mathbf{J} = \mu_0^{-1} \nabla \times \mathbf{B}\)</span></p>
</dd>
<dt><em>divB</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the divergence of the magnetic field <span class="math notranslate nohighlight">\(\mu_0^{-1} \nabla . \mathbf{B}\)</span></p>
</dd>
<dt><em>Bav</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the magnetic field at the center of mass of the tetrahedron,
sampled at 1st SC time steps [nT]</p>
</dd>
<dt><em>jxB</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the <span class="math notranslate nohighlight">\(\mathbf{J}\times\mathbf{B} = \mu_0^{-1}\left[\left(\mathbf{B}.\nabla\right)\mathbf{B} + \nabla \left(\frac{B^2}{2}\right)\right]\)</span> force.</p>
</dd>
<dt><em>divTshear</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the part of the divergence of stress associated with curvature units <span class="math notranslate nohighlight">\(\mu_0^{-1}\left(\mathbf{B}.\nabla\right)\mathbf{B}\)</span>.</p>
</dd>
<dt><em>divPb</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the gradient of the magnetic pressure <span class="math notranslate nohighlight">\(\mu_0^{-1}\nabla \left(\frac{B^2}{2}\right)\)</span></p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Reference :</dt><dd><p>ISSI book  Eq. 14.16, 14.17 p. 353</p>
</dd>
<dt>See also :</dt><dd><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_k()</span></code></p>
</dd>
</dl>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_k()</span></code>
.. py:function:: c_4_k(R=None)</p>
<p>Calculate reciprocal vectors in barycentric coordinates.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>R</em><span class="classifier">list of DataArray</span></dt><dd><p>Time series of the position of the spacecrafts</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>K</em><span class="classifier">list of DataArray</span></dt><dd><p>Time series of the reciprocal vectors in barycentric coordinates</p>
</dd>
</dl>
</dd>
<dt>Reference:</dt><dd><p>ISSI book 14.7</p>
</dd>
<dt>Note :</dt><dd><p>The units of reciprocal vectors are the same as [1/r]</p>
</dd>
</dl>
</div>
<div class="section" id="calc-disprel-tm">
<h3><a class="reference internal" href="#pyrf.calc_disprel_tm" title="pyrf.calc_disprel_tm"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_disprel_tm()</span></code></a><a class="headerlink" href="#calc-disprel-tm" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.calc_disprel_tm">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">calc_disprel_tm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">V</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dV</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dT</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.calc_disprel_tm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes dispersion relation from velocities and period given by the timing method</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>V</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the velocities</p>
</dd>
<dt><em>dV</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the error on velocities</p>
</dd>
<dt><em>T</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the periods</p>
</dd>
<dt><em>dT</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the error on period</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">Dataset</span></dt><dd><p>DataSet containing the frequency, the wavelength, the wavenumber. Also includes the errors and the fit
(e.g Vph phase velocity)</p>
</dd>
</dl>
</dd>
<dt>See also :</dt><dd><p>c_4_v_xcorr</p>
</dd>
</dl>
</div>
<div class="section" id="calc-dt">
<h3><a class="reference internal" href="#pyrf.calc_dt" title="pyrf.calc_dt"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dt()</span></code></a><a class="headerlink" href="#calc-dt" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.calc_dt">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">calc_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.calc_dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes time step of the input time series</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">float</span></dt><dd><p>Time step in seconds</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="calc-fs">
<h3><a class="reference internal" href="#pyrf.calc_fs" title="pyrf.calc_fs"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_fs()</span></code></a><a class="headerlink" href="#calc-fs" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.calc_fs">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">calc_fs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.calc_fs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the sampling frequency of the input time series</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">float</span></dt><dd><p>Sampling frequency in Hz</p>
</dd>
</dl>
</dd>
</dl>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_fac()</span></code>
.. py:function:: convert_fac(inp=None, Bbgd=None, r=np.array([1,0,0]))</p>
<p>Transforms to a field-aligned coordinate (FAC) system defined as:
R_parallel_z aligned with the background magnetic field
R_perp_y defined by R_parallel cross the position vector of the spacecraft (nominally eastward at the equator)
R_perp_x defined by R_perp_y cross R_par
If inp is one vector along r direction, out is inp[perp, para] projection</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field</p>
</dd>
<dt><em>Bbgd</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the background magnetic field</p>
</dd>
<dt><em>r</em><span class="classifier">DataArray/ndarray/list</span></dt><dd><p>Position vector of spacecraft</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field in field aligned coordinates system</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field (FGM) and electric field (EDP)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">convert_fac</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd>
<dt>Note :</dt><dd><p>all input parameters must be in the same coordinate system</p>
</dd>
</dl>
</div>
<div class="section" id="cross">
<h3><a class="reference internal" href="#pyrf.cross" title="pyrf.cross"><code class="xref py py-func docutils literal notranslate"><span class="pre">cross()</span></code></a><a class="headerlink" href="#cross" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.cross">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">cross</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp2</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.cross" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes cross product of two fields.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>inp1<span class="classifier">DataArray</span></dt><dd><p>Time series of the first field <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span></p>
</dd>
<dt>inp2<span class="classifier">DataArray</span></dt><dd><p>Time series of the second field <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the cross product <span class="math notranslate nohighlight">\(\mathbf{Z} = \mathbf{X}\times\mathbf{Y}\)</span></p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic and electric fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Magnitude of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute ExB drit velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ExBxyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="dec-parperp">
<h3><a class="reference internal" href="#pyrf.dec_parperp" title="pyrf.dec_parperp"><code class="xref py py-func docutils literal notranslate"><span class="pre">dec_parperp()</span></code></a><a class="headerlink" href="#dec-parperp" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.dec_parperp">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">dec_parperp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flagspinplane</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.dec_parperp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Decomposes a vector into par/perp to B components. If flagspinplane decomposes components to the projection of B
into the XY plane. Alpha_XY gives the angle between B0 and the XY plane.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the field to decompose</p>
</dd>
<dt><em>b0</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the background magnetic field</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>flagspinplane</em><span class="classifier">bool</span></dt><dd><p>Flag if True gives the projection in XY plane</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>apar</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field parallel to the background magnetic field</p>
</dd>
<dt><em>aperp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field perpendicular to the background magnetic field</p>
</dd>
<dt><em>alpha</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the angle between the background magnetic field and the XY plane</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field (FGM) and electric field (EDP)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Decompose Exyz into parallel and perpendicular to Bxyz components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Epar</span><span class="p">,</span> <span class="n">Eperp</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">dec_parperp</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="dist-append">
<h3><a class="reference internal" href="#pyrf.dist_append" title="pyrf.dist_append"><code class="xref py py-func docutils literal notranslate"><span class="pre">dist_append()</span></code></a><a class="headerlink" href="#dist-append" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.dist_append">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">dist_append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.dist_append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Concatenate two distribution skymaps along the time axis</p>
<p>Note : the time series have to be in the correct time order</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp1</em><span class="classifier">DataArray</span></dt><dd><p>3D skymap distribution at early times</p>
</dd>
<dt><em>inp2</em><span class="classifier">DataArray</span></dt><dd><p>3D skymap distribution at late times</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>3D skymap of the concatenated 3D skymaps</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="dot">
<h3><a class="reference internal" href="#pyrf.dot" title="pyrf.dot"><code class="xref py py-func docutils literal notranslate"><span class="pre">dot()</span></code></a><a class="headerlink" href="#dot" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.dot">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp2</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.dot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes dot product of two fields</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>inp1<span class="classifier">DataArray</span></dt><dd><p>Time series of the first field <span class="math notranslate nohighlight">\(\mathbf{X}\)</span></p>
</dd>
<dt>inp2<span class="classifier">DataArray</span></dt><dd><p>Time series of the second field <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the dot product <span class="math notranslate nohighlight">\(\mathbf{Z} = \mathbf{X}\times\mathbf{Y}\)</span></p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, electric field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jxyz</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the electric at the center of mass of the tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyzavg</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">avg_4sc</span><span class="p">(</span><span class="n">Exyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute J.E dissipation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">JE</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jxyz</span><span class="p">,</span><span class="n">Exyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="dynamicp">
<h3><a class="reference internal" href="#pyrf.dynamicp" title="pyrf.dynamicp"><code class="xref py py-func docutils literal notranslate"><span class="pre">dynamicp()</span></code></a><a class="headerlink" href="#dynamicp" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.dynamicp">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">dynamicp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">V</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">'i'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.dynamicp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes dynamic pressure</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>N</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the number density of the specie</p>
</dd>
<dt><em>V</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the bulk velocity of the specie</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>s</em><span class="classifier">“i”/”e”</span></dt><dd><p>Specie (default “i”)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>Pdyn</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the dynamic pressure of the specie <span class="math notranslate nohighlight">\(P_{dyn,\alpha} = n_\alpha V_\alpha^2\)</span></p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ion bluk velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Vi_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove spintone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">STixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;STi_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vixyz</span> <span class="o">=</span> <span class="n">Vixyz</span><span class="o">-</span><span class="n">STixyz</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ion number density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ni</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ni_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute dynamic pressure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pdyn</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">dynamicp</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span><span class="n">Vixyz</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="e-vxb">
<h3><a class="reference internal" href="#pyrf.e_vxb" title="pyrf.e_vxb"><code class="xref py py-func docutils literal notranslate"><span class="pre">e_vxb()</span></code></a><a class="headerlink" href="#e-vxb" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.e_vxb">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">e_vxb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag</span><span class="o">=</span><span class="default_value">'vxb'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.e_vxb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the convection electric field <span class="math notranslate nohighlight">\(\mathbf{V}\times\mathbf{B}\)</span> (default) or the ExB drift velocity <span class="math notranslate nohighlight">\(\frac{\mathbf{E}\times\mathbf{B}}{B^2}\)</span> (flag=”exb”)</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>v<span class="classifier">DataArray</span></dt><dd><p>Time series of the velocity/electric field</p>
</dd>
<dt>b<span class="classifier">DataArray</span></dt><dd><p>Time series of the magnetic field</p>
</dd>
<dt>flag<span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Method flag :</dt><dd><p>“vxb” -&gt; computes convection electric field (default)
“exb” -&gt; computes ExB drift velocity</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the convection electric field/ExB drift velocity</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute ExB drift velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ExB</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">e_vxb</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;ExB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="ebsp">
<h3><a class="reference internal" href="#pyrf.ebsp" title="pyrf.ebsp"><code class="xref py py-func docutils literal notranslate"><span class="pre">ebsp()</span></code></a><a class="headerlink" href="#ebsp" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.ebsp">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">ebsp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dB</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fullB</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">B0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">freq_int</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.ebsp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculates wavelet spectra of E&amp;B and Poynting flux using wavelets (Morlet wavelet). Also computes polarization
parameters of B using SVD. SVD is performed on spectral matrices computed from the time series of B using wavelets
and then averaged over a number of wave periods.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>e</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the wave electric field</p>
</dd>
<dt><em>dB</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the wave magnetic field</p>
</dd>
<dt><em>fullB</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the high resolution background magnetic field used for <span class="math notranslate nohighlight">\(\mathbf{E}.\mathbf{B}=0\)</span></p>
</dd>
<dt><em>B0</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the background magnetic field used for field aligned coordinates</p>
</dd>
<dt><em>xyz</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the position time series of spacecraft used for field aligned coordinates</p>
</dd>
<dt><em>freq_int</em><span class="classifier">str/list/ndarray</span></dt><dd><dl class="simple">
<dt>Frequency interval :</dt><dd><ul class="simple">
<li><p>“pc12”                        -&gt; [0.1, 5.0],</p></li>
<li><p>“pc35”                        -&gt; [2e-3, 0.1],</p></li>
<li><p>[fmin, fmax]  -&gt; arbitrary interval [fmin,fmax]</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>polarization</em><span class="classifier">bool</span></dt><dd><p>Computes polarization parameters (default False)</p>
</dd>
<dt><em>noresamp</em><span class="classifier">bool</span></dt><dd><p>No resampling, <em>E</em> and <em>dB</em> are given at the same time line (default False)</p>
</dd>
<dt><em>fac</em><span class="classifier">bool</span></dt><dd><p>Uses FAC coordinate system (defined by <em>B0</em> and optionally <em>xyz</em>), otherwise no coordinate system
transformation is performed (default False)</p>
</dd>
<dt><em>dEdotB_0</em><span class="classifier">bool</span></dt><dd><p>Computes <em>dEz</em> from <span class="math notranslate nohighlight">\(\delta\mathbf{B}.\mathbf{B} = 0\)</span>, uses <em>fullB</em> (default False)</p>
</dd>
<dt><em>fullB_dB</em><span class="classifier">bool</span></dt><dd><p><em>dB</em> contains DC field (default False)</p>
</dd>
<dt><em>nAv</em><span class="classifier">int</span></dt><dd><p>Number of wave periods to average (default 8)</p>
</dd>
<dt><em>facMatrix</em><span class="classifier">ndarray</span></dt><dd><p>Specify rotation matrix to FAC system (default None)</p>
</dd>
<dt><em>mwidthcoef</em><span class="classifier">int/float</span></dt><dd><p>Specify coefficient to multiple Morlet wavelet width by. (default 1)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>res</em><span class="classifier">Dataset</span></dt><dd><dl class="simple">
<dt>Dataset with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><em>t</em><span class="classifier">DataArray</span></dt><dd><p>Time</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>f</em><span class="classifier">DataArray</span></dt><dd><p>Frequencies</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>bb_xxyyzzss</em><span class="classifier">DataArray</span></dt><dd><dl class="simple">
<dt><span class="math notranslate nohighlight">\(\delta\mathbf{B}\)</span> power spectrum with :</dt><dd><p>[…,0] -&gt; x,
[…,1] -&gt; y,
[…,2] -&gt; z,
[…,3] -&gt; sum</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>ee_xxyyzzss</em><span class="classifier">DataArray</span></dt><dd><dl class="simple">
<dt><span class="math notranslate nohighlight">\(\mathbf{E}\)</span> power spectrum with :</dt><dd><p>[…,0] -&gt; x,
[…,1] -&gt; y,
[…,2] -&gt; z,
[…,3] -&gt; sum</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>ee_ss</em><span class="classifier">DataArray</span></dt><dd><p><span class="math notranslate nohighlight">\(\mathbf{E}\)</span> power spectrum (xx+yy spacecraft coordinates, e.g. ISR2)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>pf_xyz</em><span class="classifier">DataArray</span></dt><dd><p>Poynting flux (xyz)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>pf_rtp</em><span class="classifier">DataArray</span></dt><dd><p>Poynting flux (r, theta, phi) [angles in degrees]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>dop</em><span class="classifier">DataArray</span></dt><dd><p>3D degree of polarization</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>dop2d</em><span class="classifier">DataArray</span></dt><dd><p>2D degree of polarization in the polarization plane</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>planarity</em><span class="classifier">DataArray</span></dt><dd><p>Planarity of polarization</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>ellipticity</em><span class="classifier">DataArray</span></dt><dd><p>Ellipticity of polarization ellipse</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>k</em><span class="classifier">DataArray</span></dt><dd><p><span class="math notranslate nohighlight">\(k\)</span>-vector (theta, phi FAC) [angles in degrees]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>See also :</dt><dd><p>pl_ebsp, <code class="xref py py-func docutils literal notranslate"><span class="pre">convert_fac()</span></code></p>
</dd>
<dt>Notes :</dt><dd><p>This software was developed as part of the MAARBLE (Monitoring, Analyzing and Assessing Radiation Belt
Energization and Loss) collaborative research project which has received funding from the European
Community’s Seventh Framework Program (FP7-SPACE-2011-1) under grant agreement n. 284520.</p>
</dd>
<dt>Examples :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:42.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:15:54.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tintl</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">extend_tint</span><span class="p">(</span><span class="n">Tint</span><span class="p">,[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tintl</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load background magnetic field, electric field and magnetic field fluctuations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bscm</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_scm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Polarization analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarization</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">ebsp</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bscm</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">freq_int</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">4000</span><span class="p">],</span><span class="n">polarization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fac</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="edb">
<h3><a class="reference internal" href="#pyrf.edb" title="pyrf.edb"><code class="xref py py-func docutils literal notranslate"><span class="pre">edb()</span></code></a><a class="headerlink" href="#edb" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.edb">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">edb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">angle_lim</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">flag_method</span><span class="o">=</span><span class="default_value">'E.B=0'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.edb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compute Ez under assumption E.B=0 or E.B~=0</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>E</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electric field</p>
</dd>
<dt><em>b0</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the background magnetic field</p>
</dd>
<dt><em>flag_method</em><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Assumption on the direction of the measured electric field :</dt><dd><ul class="simple">
<li><p>“E.B=0” -&gt; E.B = 0</p></li>
<li><p>“Epar”        -&gt; E field along the B projection is coming from parallel electric field</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><em>angle_lim</em><span class="classifier">float</span></dt><dd><p>B angle with respect to the spin plane should be less than angle_lim degrees otherwise Ez is set to 0</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>ed</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electric field output</p>
</dd>
<dt><em>d</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the B elevation angle above spin plane</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, electric field and spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute Ez</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ed</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">edb</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="end">
<h3><a class="reference internal" href="#pyrf.end" title="pyrf.end"><code class="xref py py-func docutils literal notranslate"><span class="pre">end()</span></code></a><a class="headerlink" href="#end" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.end">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">end</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">'unix'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Gives the last time of the time series</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable</p>
</dd>
<dt><em>fmt</em><span class="classifier">str</span></dt><dd><p>Format of the output time (see Rots et al. 2015 <a class="reference external" href="https://arxiv.org/pdf/1409.7583.pdf">https://arxiv.org/pdf/1409.7583.pdf</a>)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">float/str</span></dt><dd><p>Value of the last time in the desired format</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="extend-tint">
<h3><a class="reference internal" href="#pyrf.extend_tint" title="pyrf.extend_tint"><code class="xref py py-func docutils literal notranslate"><span class="pre">extend_tint()</span></code></a><a class="headerlink" href="#extend-tint" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.extend_tint">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">extend_tint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Tint</span></em>, <em class="sig-param"><span class="n">ext</span><span class="o">=</span><span class="default_value">[- 60, 60]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.extend_tint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Extends time interval</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>Tint</em><span class="classifier">list of str</span></dt><dd><p>Reference time interval to extend</p>
</dd>
<dt><em>ext</em><span class="classifier">list of flot/int</span></dt><dd><p>Number of seconds to extend time interval [left extend, right extend]</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>tint</em><span class="classifier">list of str</span></dt><dd><p>Extended time interval</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:42.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:15:54.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load spacecraft position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tintl</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">extend_tint</span><span class="p">(</span><span class="n">Tint</span><span class="p">,[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="filt">
<h3><a class="reference internal" href="#pyrf.filt" title="pyrf.filt"><code class="xref py py-func docutils literal notranslate"><span class="pre">filt()</span></code></a><a class="headerlink" href="#filt" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.filt">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">filt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmin</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">fmax</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.filt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Filters input quantity</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the variable to filter</p>
</dd>
<dt><em>fmin</em><span class="classifier">float</span></dt><dd><p>Lower limit of the frequency range</p>
</dd>
<dt><em>fmax</em><span class="classifier">float</span></dt><dd><p>Upper limit of the frequency range</p>
</dd>
<dt><em>n</em><span class="classifier">int</span></dt><dd><p>Order of the elliptic filter</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the filtered signal</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2017-07-18T13:03:34.000&quot;</span><span class="p">,</span><span class="s2">&quot;2017-07-18T13:07:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic and electric fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert E to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">convert_fac</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bandpass filter E waveform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmin</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyzfachf</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">Exyzfac</span><span class="p">,</span><span class="n">fmin</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyzfaclf</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">Exyzfac</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">fmin</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="fname">
<h3><a class="reference internal" href="#pyrf.fname" title="pyrf.fname"><code class="xref py py-func docutils literal notranslate"><span class="pre">fname()</span></code></a><a class="headerlink" href="#fname" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.fname">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">fname</code><span class="sig-paren">(</span><em class="sig-param">Tint=None</em><span class="optional">[</span>, <em class="sig-param">frmt=1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.fname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Creates a string corresponding to time interval for output plot naming</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>Tint<span class="classifier">list of str</span></dt><dd><p>Time interval</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>frmt</em><span class="classifier">int</span></dt><dd><dl class="simple">
<dt>Format of the output :</dt><dd><ul class="simple">
<li><p>1 : “%Y%m%d_%H%M” (default),</p></li>
<li><p>2 : “%y%m%d%H%M%S”,</p></li>
<li><p>3 : “%Y%m%d_%H%M%S”_”%H%M%S”,</p></li>
<li><p>4 : “%Y%m%d_%H%M%S”_”%Y%m%d_%H%M%S”</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">str</span></dt><dd><p>String corresponding to the time interval in the desired format.</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="gradient">
<h3><a class="reference internal" href="#pyrf.gradient" title="pyrf.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a><a class="headerlink" href="#gradient" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.gradient">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes time derivative of the input variable</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>inp<span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the time derivative of the input variable</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2017-07-18T13:03:34.000&quot;</span><span class="p">,</span><span class="s2">&quot;2017-07-18T13:07:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time derivative of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtB</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="histogram2d">
<h3><a class="reference internal" href="#pyrf.histogram2d" title="pyrf.histogram2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">histogram2d()</span></code></a><a class="headerlink" href="#histogram2d" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.histogram2d">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">histogram2d</code><span class="sig-paren">(</span><em class="sig-param">inp1=None</em>, <em class="sig-param">inp2=None</em><span class="optional">[</span>, <em class="sig-param">nbins=100</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.histogram2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes 2d histogram of inp2 vs inp1 with nbins number of bins</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp1</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the x values</p>
</dd>
<dt><em>inp2</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the y values</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>nbins</em><span class="classifier">int</span></dt><dd><p>Number of bins (default 100)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>2D map of the density of inp2 vs inp1</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">Bavg</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of B and J</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bavg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Histogram of |J| vs |B|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HBJ</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">Bmag</span><span class="p">,</span><span class="n">Jmag</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="integrate">
<h3><a class="reference internal" href="#pyrf.integrate" title="pyrf.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a><a class="headerlink" href="#integrate" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.integrate">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">integrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_step</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.integrate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Integrate time series</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the variable to integrate</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>time_step</em><span class="classifier">float</span></dt><dd><p>Time steps threshold. All time_steps larger than 3*time_step are assumed data gaps, default is that
time_step is the smallest value of all time_steps of the time series</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the time integrated input</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-12-14T01:17:40.200&quot;</span><span class="p">,</span><span class="s2">&quot;2015-12-14T01:17:41.500&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert electric field to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">convert_fac</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="iso2unix">
<h3><a class="reference internal" href="#pyrf.iso2unix" title="pyrf.iso2unix"><code class="xref py py-func docutils literal notranslate"><span class="pre">iso2unix()</span></code></a><a class="headerlink" href="#iso2unix" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.iso2unix">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">iso2unix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.iso2unix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Converts time in iso format to unix</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>t</em><span class="classifier">list of str</span></dt><dd><p>Time</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">list of float</span></dt><dd><p>Time in unix format</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="mean-bins">
<h3><a class="reference internal" href="#pyrf.mean_bins" title="pyrf.mean_bins"><code class="xref py py-func docutils literal notranslate"><span class="pre">mean_bins()</span></code></a><a class="headerlink" href="#mean-bins" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.mean_bins">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">mean_bins</code><span class="sig-paren">(</span><em class="sig-param">x=None</em>, <em class="sig-param">y=None</em><span class="optional">[</span>, <em class="sig-param">nbins=10</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.mean_bins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes mean of values of <em>y</em> corresponding to bins of <em>x</em></p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>x</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the quantity of bins</p>
</dd>
<dt><em>y</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the quantity to the mean</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>nbins</em><span class="classifier">int</span></dt><dd><p>Number of bins (default 10)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">Dataset</span></dt><dd><dl class="simple">
<dt>Dataset with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><em>bins</em><span class="classifier">DataArray</span></dt><dd><p>Bin values of the <em>x</em> variable</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>data</em><span class="classifier">DataArray</span></dt><dd><p>Mean values of <em>y</em> corresponding to each bin of <em>x</em></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>sigma</em><span class="classifier">DataArray</span></dt><dd><p>Standard deviation</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">Bavg</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of B and J</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bavg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Mean value of |J| for 10 bins of |B|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MeanBJ</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">mean_bins</span><span class="p">(</span><span class="n">Bmag</span><span class="p">,</span><span class="n">Jmag</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="medfilt">
<h3><a class="reference internal" href="#pyrf.medfilt" title="pyrf.medfilt"><code class="xref py py-func docutils literal notranslate"><span class="pre">medfilt()</span></code></a><a class="headerlink" href="#medfilt" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.medfilt">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">medfilt</code><span class="sig-paren">(</span><em class="sig-param">inp=None</em><span class="optional">[</span>, <em class="sig-param">npts=11</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.medfilt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Applies a median filter over <em>npts</em> points to <em>inp</em></p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>npts</em><span class="classifier">float/int</span></dt><dd><p>Number of points of median filter (default 11)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArry</span></dt><dd><p>Time series of the median filtered input variable</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">Bavg</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get J sampling frequency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">calc_fs</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Median filter over 1s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">medfilt</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="median-bins">
<h3><a class="reference internal" href="#pyrf.median_bins" title="pyrf.median_bins"><code class="xref py py-func docutils literal notranslate"><span class="pre">median_bins()</span></code></a><a class="headerlink" href="#median-bins" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.median_bins">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">median_bins</code><span class="sig-paren">(</span><em class="sig-param">x=None</em>, <em class="sig-param">y=None</em><span class="optional">[</span>, <em class="sig-param">nbins=10</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.median_bins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes median of values of <em>y</em> corresponding to bins of <em>x</em></p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>x</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the quantity of bins</p>
</dd>
<dt><em>y</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the quantity to the median</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>nbins</em><span class="classifier">int</span></dt><dd><p>Number of bins (default 10)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">Dataset</span></dt><dd><dl class="simple">
<dt>Dataset with :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><em>bins</em><span class="classifier">DataArray</span></dt><dd><p>Bin values of the <em>x</em> variable</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>data</em><span class="classifier">DataArray</span></dt><dd><p>Median values of <em>y</em> corresponding to each bin of <em>x</em></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>sigma</em><span class="classifier">DataArray</span></dt><dd><p>Standard deviation</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rxyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;R_gse&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ic</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute current density, etc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span><span class="p">,</span> <span class="n">divB</span><span class="p">,</span> <span class="n">Bavg</span><span class="p">,</span> <span class="n">jxB</span><span class="p">,</span> <span class="n">divTshear</span><span class="p">,</span> <span class="n">divPb</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">c_4_j</span><span class="p">(</span><span class="n">Rxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of B and J</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bavg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Median value of |J| for 10 bins of |B|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MedBJ</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">mean_bins</span><span class="p">(</span><span class="n">Bmag</span><span class="p">,</span><span class="n">Jmag</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="minvar">
<h3><a class="reference internal" href="#pyrf.minvar" title="pyrf.minvar"><code class="xref py py-func docutils literal notranslate"><span class="pre">minvar()</span></code></a><a class="headerlink" href="#minvar" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.minvar">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">minvar</code><span class="sig-paren">(</span><em class="sig-param">inp=None</em><span class="optional">[</span>, <em class="sig-param">flag=&quot;mvar&quot;</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.minvar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compute the minimum variance frame</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the quantity to find minimum variance frame</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>flag</em><span class="classifier">str</span></dt><dd><p>Constrain (default “mvar”)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input quantity in LMN coordinates</p>
</dd>
<dt><em>l</em><span class="classifier">array</span></dt><dd><p>Eigenvalues l[0]&gt;l[1]&gt;l[2]</p>
</dd>
<dt><em>V</em><span class="classifier">array</span></dt><dd><p>Eigenvectors LMN coordinates</p>
</dd>
</dl>
</dd>
<dt>See also :</dt><dd><p><a class="reference internal" href="#pyrf.new_xyz" title="pyrf.new_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">new_xyz()</span></code></a></p>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute MVA frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Blmn</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">minvar</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="movmean">
<h3><a class="reference internal" href="#pyrf.movmean" title="pyrf.movmean"><code class="xref py py-func docutils literal notranslate"><span class="pre">movmean()</span></code></a><a class="headerlink" href="#movmean" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.movmean">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">movmean</code><span class="sig-paren">(</span><em class="sig-param">inp=None</em><span class="optional">[</span>, <em class="sig-param">npts=100</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.movmean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes running average of the <em>inp</em> over <em>npts</em> points.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>npts</em><span class="classifier">int</span></dt><dd><p>Number of points to average over (default 100)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input variable averaged over <em>npts</em> points</p>
</dd>
</dl>
</dd>
<dt>Notes :</dt><dd><p>Works also with 3D skymap distribution</p>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load ion pressure tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Pi_gse_fpi_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Running average the pressure tensor over 10s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">calc_fs</span><span class="p">(</span><span class="n">Pixyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pixyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">movmean</span><span class="p">(</span><span class="n">Pixyz</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="new-xyz">
<h3><a class="reference internal" href="#pyrf.new_xyz" title="pyrf.new_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">new_xyz()</span></code></a><a class="headerlink" href="#new-xyz" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.new_xyz">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">new_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">M</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.new_xyz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Transform the input field to the new frame</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field in the original coordinate system</p>
</dd>
<dt><em>M</em><span class="classifier">array</span></dt><dd><p>Transformation matrix</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input in the new frame</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute MVA frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Blmn</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">minvar</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Move electric field to the MVA frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Elmn</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">new_xyz</span><span class="p">(</span><span class="n">Exyz</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="norm">
<h3><a class="reference internal" href="#pyrf.norm" title="pyrf.norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm()</span></code></a><a class="headerlink" href="#norm" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.norm">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">norm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the magnitude of the input field</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the magnitude of the input field</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute magnitude of the magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bmag</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="normalize">
<h3><a class="reference internal" href="#pyrf.normalize" title="pyrf.normalize"><code class="xref py py-func docutils literal notranslate"><span class="pre">normalize()</span></code></a><a class="headerlink" href="#normalize" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.normalize">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Normalizes the input field</p>
<dl>
<dt>Parameter :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the input field</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the normalized input field</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the normalized magnetic field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="plasma-calc">
<h3><a class="reference internal" href="#pyrf.plasma_calc" title="pyrf.plasma_calc"><code class="xref py py-func docutils literal notranslate"><span class="pre">plasma_calc()</span></code></a><a class="headerlink" href="#plasma-calc" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.plasma_calc">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">plasma_calc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">B</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Te</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ne</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.plasma_calc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes plasma parameters including characteristic length and time scales</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>B</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the magnetic field <span class="math notranslate nohighlight">\([\textrm{nT}]\)</span></p>
</dd>
<dt><em>Ti</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the ions temperature <span class="math notranslate nohighlight">\([\textrm{eV}]\)</span></p>
</dd>
<dt><em>Te</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electrons temperature <span class="math notranslate nohighlight">\([\textrm{eV}]\)</span></p>
</dd>
<dt><em>Ni</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the ions number density <span class="math notranslate nohighlight">\([\textrm{cm}^{-3}]\)</span></p>
</dd>
<dt><em>Ne</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electrons number density <span class="math notranslate nohighlight">\([\textrm{cm}^{-3}]\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">Dataset:</span></dt><dd><dl class="simple">
<dt>Dataset of the plasma parameters :</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><em>time</em><span class="classifier">DataArray</span></dt><dd><p>Time</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Wpe</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron plasma frequency <span class="math notranslate nohighlight">\([\textrm{rad}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Fpe</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron plasma frequency <span class="math notranslate nohighlight">\([\textrm{Hz}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Wce</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron cyclotron frequency <span class="math notranslate nohighlight">\([\textrm{rad}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Fce</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron cyclotron frequency <span class="math notranslate nohighlight">\([\textrm{Hz}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Wpp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the ion plasma frequency <span class="math notranslate nohighlight">\([\textrm{rad}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Fpp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the ion plasma frequency <span class="math notranslate nohighlight">\([\textrm{Hz}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Fcp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the ion cyclotron frequency <span class="math notranslate nohighlight">\([\textrm{Hz}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Fuh</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the upper hybrid frequency <span class="math notranslate nohighlight">\([\textrm{Hz}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Flh</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the lower hybrid frequency <span class="math notranslate nohighlight">\([\textrm{Hz}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Va</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the Alfvèn velocity (ions) <span class="math notranslate nohighlight">\([\textrm{m}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Vae</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the Alfvèn velocity (electrons) <span class="math notranslate nohighlight">\([\textrm{m}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Vte</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron thermal velocity <span class="math notranslate nohighlight">\([\textrm{m}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Vtp</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron thermal velocity <span class="math notranslate nohighlight">\([\textrm{m}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Vts</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the sound speed <span class="math notranslate nohighlight">\([\textrm{m}.\textrm{s}^{-1}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>gamma_e</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron Lorentz factor</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>gamma_p</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron Lorentz factor</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Le</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron inertial length <span class="math notranslate nohighlight">\([\textrm{m}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Li</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron inertial length <span class="math notranslate nohighlight">\([\textrm{m}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Ld</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the Debye length <span class="math notranslate nohighlight">\([\textrm{m}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Nd</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the number of electrons in the Debye sphere</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Roe</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electron Larmor radius <span class="math notranslate nohighlight">\([\textrm{m}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Rop</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the ion Larmor radius <span class="math notranslate nohighlight">\([\textrm{m}]\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>Ros</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the length associated to the sound speed <span class="math notranslate nohighlight">\([\textrm{m}]\)</span></p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, ion/electron temperature and number density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ti_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Texyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Te_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ni</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ni_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ne</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ne_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute scalar temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tixyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">Tixyz</span><span class="p">,</span><span class="s2">&quot;fac&quot;</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Texyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">Texyz</span><span class="p">,</span><span class="s2">&quot;fac&quot;</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ti</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">Tixyzfac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Te</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">Texyzfac</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute plasma parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pparam</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">plasma_calc</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">,</span><span class="n">Ti</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span><span class="n">Ni</span><span class="p">,</span><span class="n">Ne</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="pres-anis">
<h3><a class="reference internal" href="#pyrf.pres_anis" title="pyrf.pres_anis"><code class="xref py py-func docutils literal notranslate"><span class="pre">pres_anis()</span></code></a><a class="headerlink" href="#pres-anis" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.pres_anis">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">pres_anis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">B</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.pres_anis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compute pressure anisotropy factor: <span class="math notranslate nohighlight">\(\mu_0\frac{P_\parallel - P_\perp}{B^2}\)</span></p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>P</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the pressure tensor</p>
</dd>
<dt><em>B</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the background magnetic field</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>p_anis</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the pressure anisotropy</p>
</dd>
</dl>
</dd>
<dt>See also :</dt><dd><p><a class="reference internal" href="#pyrf.rotate_tensor" title="pyrf.rotate_tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate_tensor()</span></code></a></p>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field, ion/electron temperature and number density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Pi_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute pressure anistropy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_anis</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">pres_anis</span><span class="p">(</span><span class="n">Pxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="resample">
<h3><a class="reference internal" href="#pyrf.resample" title="pyrf.resample"><code class="xref py py-func docutils literal notranslate"><span class="pre">resample()</span></code></a><a class="headerlink" href="#resample" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.resample">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">resample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.resample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Resample inp to the time line of ref. If sampling of X is more than two times higher than Y, we average X, otherwise
we interpolate X.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Time series to resample</p>
</dd>
<dt><em>ref</em><span class="classifier">DataArray</span></dt><dd><p>Reference time line</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>method</em><span class="classifier">str</span></dt><dd><p>Method of interpolation “spline”, “linear” etc. (default “linear”) if method is given then interpolate
independent of sampling.</p>
</dd>
<dt><em>fs</em><span class="classifier">float</span></dt><dd><p>Sampling frequency of the Y signal, 1/window</p>
</dd>
<dt><em>window</em><span class="classifier">int/float/array</span></dt><dd><p>Length of the averaging window, 1/fsample</p>
</dd>
<dt><em>mean</em><span class="classifier">bool</span></dt><dd><p>Use mean when averaging</p>
</dd>
<dt><em>median</em><span class="classifier">bool</span></dt><dd><p>Use median instead of mean when averaging</p>
</dd>
<dt><em>max</em><span class="classifier">bool</span></dt><dd><p>Use max instead of mean when averaging</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Resampled input to the reference time line using the selected method</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Exyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;E_gse_edp_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Resample magnetic field with respect to electric field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">Bxyz</span><span class="p">,</span><span class="n">Exyz</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="rotate-tensor">
<h3><a class="reference internal" href="#pyrf.rotate_tensor" title="pyrf.rotate_tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate_tensor()</span></code></a><a class="headerlink" href="#rotate-tensor" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.rotate_tensor">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">rotate_tensor</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.rotate_tensor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Rotates pressure or temperature tensor into another coordinate system</p>
<dl>
<dt>Parameters :</dt><dd><dl>
<dt><em>PeIJ</em>/<em>Peall</em><span class="classifier">DataArray</span></dt><dd><p>Time series of either separated terms of the tensor or the complete tensor.
If columns (PeXX,PeXY,PeXZ,PeYY,PeYZ,PeZZ)</p>
</dd>
<dt><em>flag</em><span class="classifier">str</span></dt><dd><dl>
<dt>Flag of the target coordinates system :</dt><dd><p>Field-aligned coordinates “fac”, requires background magnetic field <em>Bback</em>, optional
flag “pp” P_perp1 = P_perp2 or “qq” P_perp1 and P_perp2 are most unequal, sets P23 to zero.</p>
<p>Arbitrary coordinate system “rot”, requires new x-direction <em>xnew</em>, new y and z directions
<em>ynew</em>, <em>znew</em> (if not included y and z directions are orthogonal to <em>xnew</em> and closest to the
original y and z directions)</p>
<p>GSE coordinates “gse”, requires MMS spacecraft number 1–4 MMSnum</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>Pe</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the pressure or temperature tensor in field-aligned, user-defined, or GSE coordinates.
For “fac” Pe = [Ppar P12 P13; P12 Pperp1 P23; P13 P23 Pperp2].
For “rot” and “gse” Pe = [Pxx Pxy Pxz; Pxy Pyy Pyz; Pxz Pyz Pzz]</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and ion temperature tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ti_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute ion temperature in field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tixyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">Tixyz</span><span class="p">,</span><span class="s2">&quot;fac&quot;</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="start">
<h3><a class="reference internal" href="#pyrf.start" title="pyrf.start"><code class="xref py py-func docutils literal notranslate"><span class="pre">start()</span></code></a><a class="headerlink" href="#start" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.start">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param">inp=None</em><span class="optional">[</span>, <em class="sig-param">fmt=&quot;unix&quot;</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Gives the first time of the time series</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>inp<span class="classifier">DataArray</span></dt><dd><p>Time series</p>
</dd>
</dl>
</dd>
<dt>Option :</dt><dd><dl class="simple">
<dt>fmt<span class="classifier">str</span></dt><dd><p>Format of the output (default “unix”)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">float/str</span></dt><dd><p>Value of the first time in the desired format</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="t-eval">
<h3><a class="reference internal" href="#pyrf.t_eval" title="pyrf.t_eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">t_eval()</span></code></a><a class="headerlink" href="#t-eval" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.t_eval">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">t_eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.t_eval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Evaluates the input time series at the target time</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>inp<span class="classifier">DataArray</span></dt><dd><p>Time series if the input to evaluate</p>
</dd>
<dt>t<span class="classifier">array</span></dt><dd><p>Times at which the input will be evaluated</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the input at times t</p>
</dd>
</dl>
</dd>
</dl>
<p>Example :</p>
</div>
<div class="section" id="trace">
<h3><a class="reference internal" href="#pyrf.trace" title="pyrf.trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">trace()</span></code></a><a class="headerlink" href="#trace" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.trace">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.trace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes trace of the time series of 2nd order tensors</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>inp<span class="classifier">DataArray</span></dt><dd><p>Time series of the input 2nd order tensor.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>Time series of the trace of the input tensor</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2015-10-30T05:15:20.000&quot;</span><span class="p">,</span><span class="s2">&quot;2015-10-30T05:16:20.000&quot;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spacecraft index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load magnetic field and ion temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bxyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_srvy_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tixyz</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;Ti_gse_fpi_fast_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rotate to ion temperature tensor to field aligned coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tixyzfac</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">rotate_tensor</span><span class="p">(</span><span class="n">Tixyz</span><span class="p">,</span><span class="s2">&quot;fac&quot;</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute scalar temperature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ti</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">Tixyzfac</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="ts-append">
<h3><a class="reference internal" href="#pyrf.ts_append" title="pyrf.ts_append"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_append()</span></code></a><a class="headerlink" href="#ts-append" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.ts_append">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">ts_append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inp2</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.ts_append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Concatenate two time series along the time axis</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp1</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the first input (early times)</p>
</dd>
<dt><em>inp2</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the second input (late times)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Concatenated time series</p>
</dd>
</dl>
</dd>
<dt>Note :</dt><dd><p>The time series have to be in the correct time order</p>
</dd>
</dl>
</div>
<div class="section" id="ts-scalar">
<h3><a class="reference internal" href="#pyrf.ts_scalar" title="pyrf.ts_scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_scalar()</span></code></a><a class="headerlink" href="#ts-scalar" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.ts_scalar">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">ts_scalar</code><span class="sig-paren">(</span><em class="sig-param">t=None</em>, <em class="sig-param">data=None</em><span class="optional">[</span>, <em class="sig-param">attrs=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.ts_scalar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Create a time series containing a 0th order tensor</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>t<span class="classifier">np.ndarray</span></dt><dd><p>Array of times</p>
</dd>
<dt>data<span class="classifier">np.ndarray</span></dt><dd><p>Data corresponding to the time list</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt>attrs<span class="classifier">dict</span></dt><dd><p>Attributes of the data list</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out DataArray</dt><dd><p>0th order tensor time series</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="ts-skymap">
<h3><a class="reference internal" href="#pyrf.ts_skymap" title="pyrf.ts_skymap"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_skymap()</span></code></a><a class="headerlink" href="#ts-skymap" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.ts_skymap">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">ts_skymap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">energy</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.ts_skymap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Creates a skymap of the distribution function</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>time<span class="classifier">np.ndarray</span></dt><dd><p>List of times</p>
</dd>
<dt>data<span class="classifier">np.ndarray</span></dt><dd><p>Values of the distribution function</p>
</dd>
<dt>energy<span class="classifier">np.ndarray</span></dt><dd><p>Energy levels</p>
</dd>
<dt>phi<span class="classifier">np.ndarray</span></dt><dd><p>Azimuthal angles</p>
</dd>
<dt>theta<span class="classifier">np.ndarray</span></dt><dd><p>Elevation angles</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><p>out : DataArray</p>
</dd>
</dl>
</div>
<div class="section" id="ts-tensor-xyz">
<h3><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_tensor:xyz()</span></code><a class="headerlink" href="#ts-tensor-xyz" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.ts_tensor_xyz">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">ts_tensor_xyz</code><span class="sig-paren">(</span><em class="sig-param">t=None</em>, <em class="sig-param">data=None</em><span class="optional">[</span>, <em class="sig-param">attrs=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.ts_tensor_xyz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Create a time series containing a 2nd order tensor</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>t<span class="classifier">np.ndarray</span></dt><dd><p>Array of times</p>
</dd>
<dt>data<span class="classifier">np.ndarray</span></dt><dd><p>Data corresponding to the time list</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt>attrs<span class="classifier">dict</span></dt><dd><p>Attributes of the data list</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out<span class="classifier">DataArray</span></dt><dd><p>2nd order tensor time series</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="ts-vec-xyz">
<h3><a class="reference internal" href="#pyrf.ts_vec_xyz" title="pyrf.ts_vec_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_vec_xyz()</span></code></a><a class="headerlink" href="#ts-vec-xyz" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.ts_vec_xyz">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">ts_vec_xyz</code><span class="sig-paren">(</span><em class="sig-param">t=None</em>, <em class="sig-param">data=None</em><span class="optional">[</span>, <em class="sig-param">attrs=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.ts_vec_xyz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Create a time series containing a 1st order tensor</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>t</em><span class="classifier">np.ndarray</span></dt><dd><p>Array of times</p>
</dd>
<dt><em>data</em><span class="classifier">np.ndarray</span></dt><dd><p>Data corresponding to the time list</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>attrs</em><span class="classifier">dict</span></dt><dd><p>Attributes of the data list</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>1st order tensor time series</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="vht">
<h3><a class="reference internal" href="#pyrf.vht" title="pyrf.vht"><code class="xref py py-func docutils literal notranslate"><span class="pre">vht()</span></code></a><a class="headerlink" href="#vht" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.vht">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">vht</code><span class="sig-paren">(</span><em class="sig-param">e=None</em>, <em class="sig-param">b=None</em><span class="optional">[</span>, <em class="sig-param">flag=1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.vht" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimate velocity of the De Hoffman-Teller frame from the velocity estimate the electric field eht=-vhtxb</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>e</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electric field</p>
</dd>
<dt><em>b</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the magnetic field</p>
</dd>
<dt><em>flag</em><span class="classifier">int</span></dt><dd><p>If 2 assumed no Ez.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>vht</em><span class="classifier">array</span></dt><dd><p>De Hoffman Teller frame velocity [km/s]</p>
</dd>
<dt><em>vht</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the electric field in the De Hoffman frame</p>
</dd>
<dt><em>dvht</em><span class="classifier">array</span></dt><dd><p>Error of De Hoffman Teller frame</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="wavelet">
<h3><a class="reference internal" href="#pyrf.wavelet" title="pyrf.wavelet"><code class="xref py py-func docutils literal notranslate"><span class="pre">wavelet()</span></code></a><a class="headerlink" href="#wavelet" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.wavelet">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">wavelet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.wavelet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculate wavelet spectrogram based on fast FFT algorithm</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp</em><span class="classifier">DataArray</span></dt><dd><p>Input quantity</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>fs</em><span class="classifier">int/float</span></dt><dd><p>Sampling frequency of the input time series</p>
</dd>
<dt><em>f</em><span class="classifier">list/np.ndarray</span></dt><dd><p>Vector [fmin fmax], calculate spectra between frequencies fmin and fmax</p>
</dd>
<dt><em>nf</em><span class="classifier">int/float</span></dt><dd><p>Number of frequency bins</p>
</dd>
<dt><em>wavelet_width</em><span class="classifier">int/float</span></dt><dd><p>Width of the Morlet wavelet, default 5.36</p>
</dd>
<dt><em>linear</em><span class="classifier">float</span></dt><dd><p>Linear spacing between frequencies of df</p>
</dd>
<dt><em>returnpower</em><span class="classifier">bool</span></dt><dd><p>Set to True (default) to return the power, False for complex wavelet transform</p>
</dd>
<dt><em>cutedge</em><span class="classifier">bool</span></dt><dd><p>Set to True (default) to set points affected by edge effects to NaN, False to keep edge affect points</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray/Dataset</span></dt><dd><p>Wavelet transform of the input</p>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="wavepolarize-means">
<h3><a class="reference internal" href="#pyrf.wavepolarize_means" title="pyrf.wavepolarize_means"><code class="xref py py-func docutils literal notranslate"><span class="pre">wavepolarize_means()</span></code></a><a class="headerlink" href="#wavepolarize-means" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pyrf.wavepolarize_means">
<code class="sig-prename descclassname">pyrf.</code><code class="sig-name descname">wavepolarize_means</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Bwave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Bbgd</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrf.wavepolarize_means" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Analysis the polarization of magnetic wave using “means” method</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>Bwave</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the magnetic field from SCM</p>
</dd>
<dt><em>Bbgd</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the magnetic field from FGM.</p>
</dd>
</dl>
</dd>
<dt>Options :</dt><dd><dl class="simple">
<dt><em>minPsd</em><span class="classifier">float</span></dt><dd><p>Threshold for the analysis (e.g 1.0e-7). Below this value, the SVD analysis is meaningless if minPsd is
not given, SVD analysis will be done for all waves. (default 1e-25)</p>
</dd>
<dt><em>nopfft</em><span class="classifier">int</span></dt><dd><p>Number of points in FFT. (default 256)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>Bpsd</em><span class="classifier">DataArray</span></dt><dd><p>Power spectrum density of magnetic filed wave.</p>
</dd>
<dt><em>degpol</em><span class="classifier">DataArray</span></dt><dd><p>Spectrogram of the degree of polarization (form 0 to 1).</p>
</dd>
<dt><em>waveangle</em><span class="classifier">DataArray</span></dt><dd><p>(form 0 to 90)</p>
</dd>
<dt><em>elliptict</em><span class="classifier">DataArray</span></dt><dd><p>Spectrogram of the ellipticity (form -1 to 1)</p>
</dd>
<dt><em>helict</em><span class="classifier">DataArray</span></dt><dd><p>Spectrogram of the helicity (form -1 to 1)</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">Bpsd</span><span class="p">,</span><span class="n">degpol</span><span class="p">,</span><span class="n">waveangle</span><span class="p">,</span><span class="n">elliptict</span><span class="p">,</span><span class="n">helict</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">wavepolarize_means</span><span class="p">(</span><span class="n">Bwave</span><span class="p">,</span><span class="n">Bbgd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">Bpsd</span><span class="p">,</span><span class="n">degpol</span><span class="p">,</span><span class="n">waveangle</span><span class="p">,</span><span class="n">elliptict</span><span class="p">,</span><span class="n">helict</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">wavepolarize_means</span><span class="p">(</span><span class="n">Bwave</span><span class="p">,</span><span class="n">Bbgd</span><span class="p">,</span><span class="mf">1.0e-7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">Bpsd</span><span class="p">,</span><span class="n">degpol</span><span class="p">,</span><span class="n">waveangle</span><span class="p">,</span><span class="n">elliptict</span><span class="p">,</span><span class="n">helict</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyrf</span><span class="o">.</span><span class="n">wavepolarize_means</span><span class="p">(</span><span class="n">Bwave</span><span class="p">,</span><span class="n">Bbgd</span><span class="p">,</span><span class="mf">1.0e-7</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Notice: Bwave and Bbgd should be from the same satellite and in the same coordinates</p>
<p>WARNING: If one component is an order of magnitude or more  greater than the other two then the polarization
results saturate and erroneously indicate high degrees of polarization at all times and frequencies. Time
series should be eyeballed before running the program.
For time series containing very rapid changes or spikes the usual problems with Fourier analysis arise.
Care should be taken in evaluating degree of polarization results.
For meaningful results there should be significant wave power at the frequency where the polarization
approaches 100%. Remember comparing two straight lines yields 100% polarization.</p>
</div>
</div>
<div class="section" id="module-mms">
<span id="mms"></span><h2><a class="reference internal" href="#module-mms" title="mms: Dedicated functions for MMS mission (see Burch et al. 2016 http://link.springer.com/10.1007/s11214-015-0164-9) (Unix, Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mms</span></code></a><a class="headerlink" href="#module-mms" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mms.calc_feeps_omni">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">calc_feeps_omni</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_dset</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mms.calc_feeps_omni" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the omni-directional FEEPS spectrograms from a Dataset that contains the spectrograms of all eyes.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt><em>inp_dset</em><span class="classifier">Dataset</span></dt><dd><p>Dataset with energy spectrum of every eyes</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>OMNI energy spectrum from the input</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mms.db_get_ts">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">db_get_ts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dsetName</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cdfName</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">trange</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mms.db_get_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get variable time series in the cdf file</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>dsetName</em><span class="classifier">str</span></dt><dd><p>Name of the dataset</p>
</dd>
<dt><em>cdfName</em><span class="classifier">str</span></dt><dd><p>Name of the target field in cdf file</p>
</dd>
<dt><em>trange</em><span class="classifier">list of str</span></dt><dd><p>Time interval</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the target variable</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mms.feeps_remove_sun">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">feeps_remove_sun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_dset</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mms.feeps_remove_sun" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the sunlight contamination from FEEPS data</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>inp_dset</em><span class="classifier">Dataset</span></dt><dd><p>Dataset of energy spectrum of all eyes (see get_feeps_alleyes)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">Dataset</span></dt><dd><p>Dataset of cleaned energy spectrum of all eyes</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2017-07-18T13:04:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2017-07-18T13:07:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iCPS</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_feeps_alleyes</span><span class="p">(</span><span class="s2">&quot;CPSi_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iCPS_clean</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">feeps_split_integral_ch</span><span class="p">(</span><span class="n">iCPS</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iCPS_clean_sun_removed</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">feeps_remove_sun</span><span class="p">(</span><span class="n">iCPS_clean</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mms.feeps_spin_avg">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">feeps_spin_avg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_dset_omni</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mms.feeps_spin_avg" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will spin-average the omni-directional FEEPS energy spectra</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt><em>inp_dset_omniv</em><span class="classifier">DataArray</span></dt><dd><p>Spectrogram of all eyes in OMNI</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Spin-averaged OMNI energy spectrum</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mms.get_feeps_energy_table">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">get_feeps_energy_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">probe</span></em>, <em class="sig-param"><span class="n">eye</span></em>, <em class="sig-param"><span class="n">sensor_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mms.get_feeps_energy_table" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the energy table based on each spacecraft and eye.
Based on the table from: FlatFieldResults_V3.xlsx</p>
<p>from Drew Turner, 1/19/2017</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt><em>probe</em><span class="classifier">str</span></dt><dd><p>probe #, e.g., “4” for MMS4</p>
</dd>
<dt><em>eye</em><span class="classifier">str</span></dt><dd><p>sensor eye #</p>
</dd>
<dt><em>sensor_id</em><span class="classifier">int</span></dt><dd><p>sensor ID</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><em>Energy_table</em><span class="classifier">list</span></dt><dd><p>Energy table</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><p>BAD EYES are replaced by NaNs
- different original energy tables are used depending on if the sensor head is 6-8 (ions) or not (electrons)
Electron Eyes: 1, 2, 3, 4, 5, 9, 10, 11, 12
Ion Eyes: 6, 7, 8</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mms.get_feeps_oneeye">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">get_feeps_oneeye</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tar_var</span><span class="o">=</span><span class="default_value">'fluxe_brst_l2'</span></em>, <em class="sig-param"><span class="n">eId</span><span class="o">=</span><span class="default_value">'bottom-4'</span></em>, <em class="sig-param"><span class="n">trange</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mmsId</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mms.get_feeps_oneeye" title="Permalink to this definition">¶</a></dt>
<dd><p>Load energy spectrum all the target eye</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>tar_var</em><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>target variable “{data_units}{specie}_{data_rate}_{level}”</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data_units :</dt><dd><ul>
<li><p>“flux” : intensity (1/cm sr)</p></li>
<li><p>“count” : counts (-)</p></li>
<li><p>“CPS” : counts per second (1/s)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>specie :</dt><dd><ul>
<li><p>“i” : ion</p></li>
<li><p>“e” : electron</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>data_rate : brst/srvy</p></li>
<li><p>level : l1/l1b/l2/l3??</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><em>eId</em><span class="classifier">str</span></dt><dd><dl class="simple">
<dt>index of the eye “{deck}-{id}”</dt><dd><ul class="simple">
<li><p>deck : top/bottom</p></li>
<li><p>id : see get_feeps_active_eyes</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><em>trange</em><span class="classifier">list of str</span></dt><dd><p>Time interval</p>
</dd>
<dt><em>mmsId</em><span class="classifier">int/str</span></dt><dd><p>Index of the spacecraft</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mms.get_data">
<code class="sig-prename descclassname">mms.</code><code class="sig-name descname">get_data</code><span class="sig-paren">(</span><em class="sig-param">varStr</em>, <em class="sig-param">tint</em>, <em class="sig-param">mmsId</em><span class="optional">[</span>, <em class="sig-param">silent=False</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#mms.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a variable. varStr must in var (see below)</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt><em>varStr</em><span class="classifier">str</span></dt><dd><p>Key of the target variable (see below)</p>
</dd>
<dt><em>tint</em><span class="classifier">list of str</span></dt><dd><p>Time interval</p>
</dd>
<dt><em>mmsId</em><span class="classifier">str/int</span></dt><dd><p>Index of the target spacecraft</p>
</dd>
<dt><em>silent</em><span class="classifier">bool</span></dt><dd><p>Set to False (default) to follow the loading</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt><em>out</em><span class="classifier">DataArray</span></dt><dd><p>Time series of the target variable of measured by the target spacecraft over the selected time interval</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Tint</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2019-09-14T07:54:00.000&quot;</span><span class="p">,</span><span class="s2">&quot;2019-09-14T08:11:00.000&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gseB</span> <span class="o">=</span> <span class="n">mms</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;B_gse_fgm_brst_l2&quot;</span><span class="p">,</span><span class="n">Tint</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>EPHEMERIS :
“R_gse”, “R_gsm”</p>
<p>FGM :
“B_gsm_fgm_srvy_l2”, “B_gsm_fgm_brst_l2”, “B_gse_fgm_srvy_l2”,
“B_gse_fgm_brst_l2”, “B_bcs_fgm_srvy_l2”, “B_bcs_fgm_brst_l2”,
“B_dmpa_fgm_srvy_l2”, “B_dmpa_fgm_brst_l2”</p>
<p>DFG &amp; AFG :
“B_gsm_dfg_srvy_l2pre”, “B_gse_dfg_srvy_l2pre”, “B_dmpa_dfg_srvy_l2pre”,
“B_bcs_dfg_srvy_l2pre”, “B_gsm_afg_srvy_l2pre”, “B_gse_afg_srvy_l2pre”,
“B_dmpa_afg_srvy_l2pre”, “B_bcs_afg_srvy_l2pre”</p>
<p>SCM :
“B_gse_scm_brst_l2”</p>
<p>EDP :
“Phase_edp_fast_l2a”, “Phase_edp_slow_l2a”, “Sdev12_edp_slow_l2a”,
“Sdev34_edp_slow_l2a”, “Sdev12_edp_fast_l2a”, “Sdev34_edp_fast_l2a”,
“E_dsl_edp_brst_l2”, “E_dsl_edp_fast_l2”, “E_dsl_edp_brst_ql”,
“E_dsl_edp_fast_ql”, “E_dsl_edp_slow_l2”, “E_gse_edp_brst_l2”,
“E_gse_edp_fast_l2”, “E_gse_edp_slow_l2”, “E2d_dsl_edp_brst_l2pre”,
“E2d_dsl_edp_fast_l2pre”, “E2d_dsl_edp_brst_ql”, “E2d_dsl_edp_fast_ql”,
“E2d_dsl_edp_l2pre”, “E2d_dsl_edp_fast_l2pre”, “E2d_dsl_edp_brst_l2pre”,
“E_dsl_edp_l2pre”, “E_dsl_edp_fast_l2pre”, “E_dsl_edp_brst_l2pre”,
“E_dsl_edp_slow_l2pre”, “E_ssc_edp_brst_l2a”, “E_ssc_edp_fast_l2a”,
“E_ssc_edp_slow_l2a”, “V_edp_fast_sitl”, “V_edp_slow_sitl”,
“V_edp_slow_l2”, “V_edp_fast_l2”, “V_edp_brst_l2”</p>
<p>FPI Ions :
“Vi_dbcs_fpi_brst_l2”, “Vi_dbcs_fpi_fast_l2”, “Vi_dbcs_fpi_l2”,
“Vi_gse_fpi_ql”, “Vi_gse_fpi_fast_ql”, “Vi_dbcs_fpi_fast_ql”,
“Vi_gse_fpi_fast_l2”, “Vi_gse_fpi_brst_l2”, “partVi_gse_fpi_brst_l2”,
“Ni_fpi_brst_l2”, “partNi_fpi_brst_l2”, “Ni_fpi_brst”,
“Ni_fpi_fast_l2”, “Ni_fpi_ql”, “Enfluxi_fpi_fast_ql”,
“Enfluxi_fpi_fast_l2”, “Tperpi_fpi_brst_l2”, “Tparai_fpi_brst_l2”,
“partTperpi_fpi_brst_l2”, “partTparai_fpi_brst_l2”, “Ti_dbcs_fpi_brst_l2”,
“Ti_dbcs_fpi_brst”, “Ti_dbcs_fpi_fast_l2”, “Ti_gse_fpi_ql”,
“Ti_dbcs_fpi_ql”, “Ti_gse_fpi_brst_l2”, “Pi_dbcs_fpi_brst_l2”,
“Pi_dbcs_fpi_brst”, “Pi_dbcs_fpi_fast_l2”, “Pi_gse_fpi_ql”,
“Pi_gse_fpi_brst_l2”</p>
<p>FPI Electrons :
“Ve_dbcs_fpi_brst_l2”, “Ve_dbcs_fpi_brst”, “Ve_dbcs_fpi_ql”,
“Ve_dbcs_fpi_fast_l2”, “Ve_gse_fpi_ql”, “Ve_gse_fpi_fast_l2”,
“Ve_gse_fpi_brst_l2”, “partVe_gse_fpi_brst_l2”, “Enfluxe_fpi_fast_ql”,
“Enfluxe_fpi_fast_l2”, “Ne_fpi_brst_l2”, “partNe_fpi_brst_l2”,
“Ne_fpi_brst”, “Ne_fpi_fast_l2”, “Ne_fpi_ql”,
“Tperpe_fpi_brst_l2”, “Tparae_fpi_brst_l2”, “partTperpe_fpi_brst_l2”,
“partTparae_fpi_brst_l2”, “Te_dbcs_fpi_brst_l2”, “Te_dbcs_fpi_brst”,
“Te_dbcs_fpi_fast_l2”, “Te_gse_fpi_ql”, “Te_dbcs_fpi_ql”,
“Te_gse_fpi_brst_l2”, “Pe_dbcs_fpi_brst_l2”, “Pe_dbcs_fpi_brst”,
“Pe_dbcs_fpi_fast_l2”, “Pe_gse_fpi_ql”, “Pe_gse_fpi_brst_l2”,</p>
<p>HPCA :
“Nhplus_hpca_srvy_l2”, “Nheplus_hpca_srvy_l2”, “Nheplusplus_hpca_srvy_l2”,
“Noplus_hpca_srvy_l2”, “Tshplus_hpca_srvy_l2”, “Tsheplus_hpca_srvy_l2”,
“Tsheplusplus_hpca_srvy_l2”, “Tsoplus_hpca_srvy_l2”, “Vhplus_dbcs_hpca_srvy_l2”,
“Vheplus_dbcs_hpca_srvy_l2”, “Vheplusplus_dbcs_hpca_srvy_l2”, “Voplus_dbcs_hpca_srvy_l2”,
“Phplus_dbcs_hpca_srvy_l2”, “Pheplus_dbcs_hpca_srvy_l2”, “Pheplusplus_dbcs_hpca_srvy_l2”,
“Poplus_dbcs_hpca_srvy_l2”, “Thplus_dbcs_hpca_srvy_l2”, “Theplus_dbcs_hpca_srvy_l2”,
“Theplusplus_dbcs_hpca_srvy_l2”, “Toplus_dbcs_hpca_srvy_l2”, “Vhplus_gsm_hpca_srvy_l2”,
“Vheplus_gsm_hpca_srvy_l2”, “Vheplusplus_gsm_hpca_srvy_l2”, “Voplus_gsm_hpca_srvy_l2”,
“Nhplus_hpca_brst_l2”, “Nheplus_hpca_brst_l2”, “Nheplusplus_hpca_brst_l2”,
“Noplus_hpca_brst_l2”, “Tshplus_hpca_brst_l2”, “Tsheplus_hpca_brst_l2”,
“Tsheplusplus_hpca_brst_l2”, “Tsoplus_hpca_brst_l2”, “Vhplus_dbcs_hpca_brst_l2”,
“Vheplus_dbcs_hpca_brst_l2”, “Vheplusplus_dbcs_hpca_brst_l2”, “Voplus_dbcs_hpca_brst_l2”,
“Phplus_dbcs_hpca_brst_l2”, “Pheplus_dbcs_hpca_brst_l2”, “Pheplusplus_dbcs_hpca_brst_l2”,
“Poplus_dbcs_hpca_brst_l2”, “Thplus_dbcs_hpca_brst_l2”, “Theplus_dbcs_hpca_brst_l2”,
“Theplusplus_dbcs_hpca_brst_l2”, “Toplus_dbcs_hpca_brst_l2”, “Vhplus_gsm_hpca_brst_l2”,
“Vheplus_gsm_hpca_brst_l2”, “Vheplusplus_gsm_hpca_brst_l2”, “Voplus_gsm_hpca_brst_l2”,
“Phplus_gsm_hpca_brst_l2”, “Pheplus_gsm_hpca_brst_l2”, “Pheplusplus_gsm_hpca_brst_l2”,
“Poplus_gsm_hpca_brst_l2”, “Thplus_gsm_hpca_brst_l2”, “Theplus_gsm_hpca_brst_l2”,
“Theplusplus_gsm_hpca_brst_l2”, “Toplus_gsm_hpca_brst_l2”</p>
</dd></dl>

<p id="bibtex-bibliography-index-0"></p>
<div class="section" id="indices-and-tables">
<h3>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to pyrfu’s documentation!</a><ul>
<li><a class="reference internal" href="#module-pyrf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyrf</span></code></a><ul>
<li><a class="reference internal" href="#pyrf-agyro-coeff"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyrf.agyro_coeff()</span></code></a></li>
<li><a class="reference internal" href="#avg-4sc"><code class="xref py py-func docutils literal notranslate"><span class="pre">avg_4sc()</span></code></a></li>
<li><a class="reference internal" href="#c-4-grad"><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_grad()</span></code></a></li>
<li><a class="reference internal" href="#c-4-j"><code class="xref py py-func docutils literal notranslate"><span class="pre">c_4_j()</span></code></a></li>
<li><a class="reference internal" href="#calc-disprel-tm"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_disprel_tm()</span></code></a></li>
<li><a class="reference internal" href="#calc-dt"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dt()</span></code></a></li>
<li><a class="reference internal" href="#calc-fs"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_fs()</span></code></a></li>
<li><a class="reference internal" href="#cross"><code class="xref py py-func docutils literal notranslate"><span class="pre">cross()</span></code></a></li>
<li><a class="reference internal" href="#dec-parperp"><code class="xref py py-func docutils literal notranslate"><span class="pre">dec_parperp()</span></code></a></li>
<li><a class="reference internal" href="#dist-append"><code class="xref py py-func docutils literal notranslate"><span class="pre">dist_append()</span></code></a></li>
<li><a class="reference internal" href="#dot"><code class="xref py py-func docutils literal notranslate"><span class="pre">dot()</span></code></a></li>
<li><a class="reference internal" href="#dynamicp"><code class="xref py py-func docutils literal notranslate"><span class="pre">dynamicp()</span></code></a></li>
<li><a class="reference internal" href="#e-vxb"><code class="xref py py-func docutils literal notranslate"><span class="pre">e_vxb()</span></code></a></li>
<li><a class="reference internal" href="#ebsp"><code class="xref py py-func docutils literal notranslate"><span class="pre">ebsp()</span></code></a></li>
<li><a class="reference internal" href="#edb"><code class="xref py py-func docutils literal notranslate"><span class="pre">edb()</span></code></a></li>
<li><a class="reference internal" href="#end"><code class="xref py py-func docutils literal notranslate"><span class="pre">end()</span></code></a></li>
<li><a class="reference internal" href="#extend-tint"><code class="xref py py-func docutils literal notranslate"><span class="pre">extend_tint()</span></code></a></li>
<li><a class="reference internal" href="#filt"><code class="xref py py-func docutils literal notranslate"><span class="pre">filt()</span></code></a></li>
<li><a class="reference internal" href="#fname"><code class="xref py py-func docutils literal notranslate"><span class="pre">fname()</span></code></a></li>
<li><a class="reference internal" href="#gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a></li>
<li><a class="reference internal" href="#histogram2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">histogram2d()</span></code></a></li>
<li><a class="reference internal" href="#integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a></li>
<li><a class="reference internal" href="#iso2unix"><code class="xref py py-func docutils literal notranslate"><span class="pre">iso2unix()</span></code></a></li>
<li><a class="reference internal" href="#mean-bins"><code class="xref py py-func docutils literal notranslate"><span class="pre">mean_bins()</span></code></a></li>
<li><a class="reference internal" href="#medfilt"><code class="xref py py-func docutils literal notranslate"><span class="pre">medfilt()</span></code></a></li>
<li><a class="reference internal" href="#median-bins"><code class="xref py py-func docutils literal notranslate"><span class="pre">median_bins()</span></code></a></li>
<li><a class="reference internal" href="#minvar"><code class="xref py py-func docutils literal notranslate"><span class="pre">minvar()</span></code></a></li>
<li><a class="reference internal" href="#movmean"><code class="xref py py-func docutils literal notranslate"><span class="pre">movmean()</span></code></a></li>
<li><a class="reference internal" href="#new-xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">new_xyz()</span></code></a></li>
<li><a class="reference internal" href="#norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li><a class="reference internal" href="#normalize"><code class="xref py py-func docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
<li><a class="reference internal" href="#plasma-calc"><code class="xref py py-func docutils literal notranslate"><span class="pre">plasma_calc()</span></code></a></li>
<li><a class="reference internal" href="#pres-anis"><code class="xref py py-func docutils literal notranslate"><span class="pre">pres_anis()</span></code></a></li>
<li><a class="reference internal" href="#resample"><code class="xref py py-func docutils literal notranslate"><span class="pre">resample()</span></code></a></li>
<li><a class="reference internal" href="#rotate-tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate_tensor()</span></code></a></li>
<li><a class="reference internal" href="#start"><code class="xref py py-func docutils literal notranslate"><span class="pre">start()</span></code></a></li>
<li><a class="reference internal" href="#t-eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">t_eval()</span></code></a></li>
<li><a class="reference internal" href="#trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">trace()</span></code></a></li>
<li><a class="reference internal" href="#ts-append"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_append()</span></code></a></li>
<li><a class="reference internal" href="#ts-scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_scalar()</span></code></a></li>
<li><a class="reference internal" href="#ts-skymap"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_skymap()</span></code></a></li>
<li><a class="reference internal" href="#ts-tensor-xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_tensor:xyz()</span></code></a></li>
<li><a class="reference internal" href="#ts-vec-xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">ts_vec_xyz()</span></code></a></li>
<li><a class="reference internal" href="#vht"><code class="xref py py-func docutils literal notranslate"><span class="pre">vht()</span></code></a></li>
<li><a class="reference internal" href="#wavelet"><code class="xref py py-func docutils literal notranslate"><span class="pre">wavelet()</span></code></a></li>
<li><a class="reference internal" href="#wavepolarize-means"><code class="xref py py-func docutils literal notranslate"><span class="pre">wavepolarize_means()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-mms"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mms</span></code></a><ul>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="install.html"
                        title="next chapter">Installation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installation"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">pyrfu  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Welcome to pyrfu’s documentation!</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, L. Richard.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>